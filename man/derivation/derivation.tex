\documentclass{article}


% Import packages
\usepackage{notation}
\usepackage{geometry,amsmath,amssymb,bm,mathtools,graphicx,pdfpages,tikz,float,blkarray,longtable,titlesec,cases,bm,titlesec,breqn}

% Graphics path
\graphicspath{{figures}}

% Document formatting
\setlength{\parindent}{0pt}
\setlength{\parskip}{8pt}

\setcounter{secnumdepth}{4}

\titleformat{\paragraph}
{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

\geometry{
	a4paper,
	total={170mm,257mm},
	left=15mm,
	top=20mm,
	right=15mm,
	bottom=25mm
}

\allowdisplaybreaks[1]

% Set macros
\let\oldnorm\norm   % <-- Store original \norm as \oldnorm
\let\norm\undefined % <-- "Undefine" \norm
\DeclarePairedDelimiter\norm{\lVert}{\rVert}
\DeclareMathOperator*{\minimise}{minimise}
\DeclareMathOperator*{\maximise}{maximise}

% Expression macros
\newcommand{\sScenarioSets}{\quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals}

\title{Refunded Emissions Payment Scheme: Long-run Parameter Calibration\\Linear GEP Formulation}

\begin{document}
	\maketitle
	
	\section{Notation}
	\renewcommand*{\arraystretch}{1.3}
	\begin{longtable}{ p{.09\textwidth}  p{.75\textwidth}}
		\textbf{Symbol} & \textbf{Description}\\
		\hline\hline
		\multicolumn{2}{l}{\textbf{Indices}}\\
		$\iGenerator$ & Generator\\ 
		$\iYear$ & Year\\
		$\iYearAlias$ & Year alias\\
		$\iYearStart$ & Start year in model horizon\\
		$\iYearTerminal$ & Final year in model horizon\\
		$\iScenario$ & Representative day\\
		$\iScenarioAlias$ & Representative day alias\\
		$\iInterval$ & Dispatch interval\\
		$\iIntervalAlias$ & Dispatch interval alias\\
		$\iIntervalTerminal$ & Final dispatch interval for representative day\\
		$\iZone$ & NEM zone\\
		$\iRegion$ & NEM region\\
		$\iLink$ & Link connecting adjacent NEM zones\\
		& \\
		\multicolumn{2}{l}{\textbf{Sets}}\\
		$\sGenerators$ & All generators\\
		$\sGeneratorsExisting$ & Existing generators\\
		$\sGeneratorsExistingThermal$ & Existing thermal generators\\
		$\sGeneratorsExistingWind$ & Existing wind units\\
		$\sGeneratorsExistingSolar$ & Existing solar units\\
		$\sGeneratorsCandidate$ & Candidate generators\\
		$\sGeneratorsCandidateThermal$ & Candidate thermal generators\\
		$\sGeneratorsCandidateWind$ & Candidate wind units\\
		$\sGeneratorsCandidateSolar$ & Candidate solar units\\
		$\sGeneratorsThermal$ & All thermal generators\\
		$\sGeneratorsHydro$ & Hydro generators\\
		$\sStorage$ & All storage units\\
		$\sStorageExisting$ & Existing storage units\\
		$\sStorageCandidate$ & Candidate storage units\\
		$\sYears$ & Years in model horizon\\
		$\sScenarios$ & Representative days\\
		$\sIntervals$ & Dispatch intervals\\
		$\sZones$ & NEM zones\\
		$\sRegions$ & NEM regions\\
		$\sLinks$ & Links connecting NEM zones\\
		$\sScenariosYear$ & Representative days constituting year $\iYear$\\
		& \\
		\multicolumn{2}{l}{\textbf{Variables}}\\
		$\vBaseline$ & Emissions intensity baseline [tCO$_{2}$/MWh]\\
		$\vPermitPrice$ & Permit price [\$/tCO$_{2}$]\\
		$\vPower$ & Generator power output [MW]\\
		$\vPowerIn$ & Storage unit charging power [MW]\\
		$\vPowerOut$ & Storage unit discharging power [MW]\\
		$\vStorageUnitEnergy$ & Energy within storage unit [MWh]\\
		$\vLostLoadPower$ & Lost load power [MW]\\
		$\vPowerFlow$ & Powerflow over link connecting adjacent NEM zones [MW]\\
		$\vInstalledCapacity$ & Capacity installed in year $\iYear$ [MW]\\
		& \\
		\multicolumn{2}{l}{\textbf{Expressions}}\\
%		$\cObjectiveFunction$ & Total cost over model horizon [\$]\\
		$\cTotalPresentValue$ & Total present value of operational and investment costs over model horizon [\$]\\
		$\cInvestmentCost$ & Total investment cost for year $\iYear$ [\$]\\
		$\cFixedOperationsMaintenanceCost$ & Total fixed operations and maintenance cost for year $\iYear$ [\$]\\
		$\cOperatingCostScenario$ & Total cost for scenario $\iScenario$ in year $\iYear$ [\$]\\
		$\cOperatingCost$ & Total operating cost for representative day $\iScenario$ in year $\iYear$ [\$]\\
		$\cOperatingCostThermal$ & Cost to operate thermal units for representative day $\iScenario$ in year $\iYear$ [\$]\\
		$\cOperatingCostHydro$ & Cost to operate hydro units for representative day $\iScenario$ in year $\iYear$ [\$]\\
		$\cOperatingCostWind$ & Cost to operate wind units for representative day $\iScenario$ in year $\iYear$ [\$]\\
		$\cOperatingCostSolar$ & Cost to operate solar units for representative day $\iScenario$ in year $\iYear$ [\$]\\
		$\cOperatingCostStorage$ & Cost to operate storage units for representative day $\iScenario$ in year $\iYear$ [\$]\\
		$\cOperatingCostLostLoad$ & Lost load cost for representative day $\iScenario$ in year $\iYear$ [\$]\\
		& \\
		\multicolumn{2}{l}{\textbf{Parameters}}\\
		$\cCandidateInvestmentCost$ & Candidate unit investment cost [\$/MW]\\
		$\cLostLoadCost_{\iZone}$ & Lost load penalty for zone $\iZone$ [\$/MWh]\\
		$\cFixedOperationsMaintenanceCostGenerator$ & Fixed operations and maintenance cost for generator $\iGenerator$ [\$]\\
		$\cMarginalCost$ & Short-run marginal cost for generator $\iGenerator$ in year $\iYear$ [\$/MWh]\\
		$\cAmortisationRate$ & Amorisation rate for generator $\iGenerator$ [--]\\
		$\cInterestRate$ & Interest rate (weighted average cost of capital) [--]\\
		$\cAssetLifetime$ & Asset lifetime [years]\\
		$\cScenarioDuration$ & Representative day scaling factor [h]\\
		$\cRetirementIndicator$ & Retirement indicator [--]\\
		$\cEmissionsIntensity$ & Emissions intensity for generator $\iGenerator$\\
		$\cPowerOutputMax$ & Maximum power output [MW]\\
		$\cPowerOutputMin$ & Minimum power output [MW]\\
		$\cPowerOutputHydro$ & Hydro power output [MW]\\
		$\cRampRateUp$ & Ramp rate up [MW/h]\\
		$\cRampRateDown$ & Ramp down up [MW/h]\\
		$\cPowerChargingMax$ & Storage unit maximum charging power [MW]\\
		$\cPowerDischargingMax$ & Storage unit maximum discharging power [MW]\\
		$\cStorageUnitEnergyMax$ & Storage unit maximum energy capacity [MWh]\\
		$\cStorageUnitEnergyIntervalEndMax$ & Storage unit maximum energy at end of operating scenario [MWh]\\
		$\cStorageUnitEnergyIntervalEndMin$ & Storage unit minimum energy at end of operating scenario [MWh]\\
		$\cStorageUnitEfficiencyCharging$ & Storage unit charging efficiency [--]\\
		$\cStorageUnitEfficiencyDischarging$ & Storage unit discharging efficiency [--]\\
		$\cDemand$ & Demand [MW]\\
		$\cCapacityFactorWind$ & Capacity factor for wind units [--]\\
		$\cCapacityFactorSolar$ & Capacity factor for solar units [--]\\
		$\cBuildLimitWind$ & Build limit for wind units in zone $\iZone$ [MW]\\
		$\cBuildLimitSolar$ & Build limit for solar units in zone $\iZone$ [MW]\\
		$\cBuildLimitStorage$ & Build limit for storage units in zone $\iZone$ [MW]\\
		$\cIncidenceMatrix$ & Network incidence matrix [--]\\
		$\cPowerFlowMin$ & Minimum powerflow over link $\iLink$ [MW]\\
		$\cPowerFlowMax$ & Maximum powerflow over link $\iLink$ [MW]\\
		$\cMinimumCumulativeSchemeRevenue$ & Minimum cumulative scheme revenue [\$]\\
		\hline
		\caption{Notation}
	\end{longtable}

\section{Model outline}
The calibration of scheme parameters is considered a Stackelberg Game, and modelled within a bi-level framework. The lower level consititutes the generation expansion planning problem, while the upper-level considers the policy calibration objective. The policymaker must take into account the optimal response of investment and operating decisions that a particular trajectory of policy parameters will elicit. A generalised representation of the problem is as follows:

\begin{alignat}{3}
& \minimise\limits_{\bm{u}, \bm{v}, \bm{\mu}, \bm{\nu}} \quad && f\left(\bm{u}, \bm{v}, \bm{\mu}, \bm{\nu}\right) \label{eqn: bi-level example upper objective}\\
& \textrm{subject to} \nonumber\\
& && \bm{a}(\bm{u}, \bm{v}) \leq 0\\
& && \bm{b}(\bm{u}, \bm{v}) = 0\\
&\nonumber \\
& && \minimise\limits_{\bm{u}} \quad && g(\bm{u}, \bm{v}) \nonumber\\
& && \textrm{subject to} \nonumber\\
& && && \bm{c}(\bm{u}, \bm{v}) \leq 0 \quad \left(\bm{\mu}\right) \\
& && && \bm{d}(\bm{u}, \bm{v}) = 0 \quad \left(\bm{\nu}\right)\\\nonumber
\end{alignat}

The upper-level objective (\ref{eqn: bi-level example upper objective}) is function of upper-level variables $\bm{v}$, lower-level variables $\bm{u}$, and dual variables associated with the lower-level program, given by $\bm{\mu}$ and $\bm{\nu}$. The generation expansion planner is assumed to be the follower within this context, responding to the policymaker's selection of scheme parameters with the least cost investment and operational plan over the model horizon. The following sections introduce each component of this model, followed by a reformulation strategy that converts the bi-level model above into a single-level optimisation problem.

\subsection{Upper-level objective and constraints}
The upper-level objective seeks to penalise average price deviations between successive years. In this sense it can be seen as a price smoothing objective. By minimising the sum of cumulative deviations greater emphasis is placed on minimising price changes at the start of the model horizon.

\begin{equation}
	\minimise\limits_{\bm{\Psi}, \bm{\Gamma}, \bm{\Lambda}} \quad \sum\limits_{\iYear=\iYearStart}^{\iYearTransition} \sum\limits_{\iYearAlias=\iYearStart}^{\iYear} \norm[\big]{\dAveragePrice[\iYearAlias] - \dAveragePrice[\iYearAlias-1]}_{1}
	\label{eqn: upper-level objective}
\end{equation}

subject to

\begin{equation}
	\vBaseline, \vPermitPrice \geq 0 \quad \forall \iYear \in \sYears
	\label{eqn: non-negative policy variables}
\end{equation}

\begin{equation}
	\sum\limits_{\iYear=\iYearStart}^{\iYearTransition} \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsCandidate \cup \sGeneratorsExistingThermal}\left(\cEmissionsIntensity -\vBaseline\right)\vPermitPrice \vPower \geq \cMinimumCumulativeSchemeRevenue
	\label{eqn: cumulative revenue constraint}
\end{equation}

\begin{equation}
	\sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsCandidate \cup \sGeneratorsExistingThermal}\left(\cEmissionsIntensity -\vBaseline\right)\vPermitPrice \vPower = 0 \quad \forall \iYear \in \left[\iYearTransition, \ldots, \iYearTerminal\right]	
	\label{eqn: revenue neutral constraint}
\end{equation}

Where:

\begin{equation}
	\dAveragePrice = \frac{\sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iZone \in \sZones} \dPowerBalance \cDemand}{\sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \sum\limits_{\iInterval \in \sIntervals}\sum\limits_{\iZone \in \sZones} \cDemand}
\end{equation}

Optimisation variables for the upper-level program consist of upper-level primal variables, lower-level primal variables, and lower-level dual variables. Upper-level primal variables are denoted by $\bm{\Psi} = \{\vBaseline, \vPermitPrice\}$, lower-level primal variables by $\bm{\Gamma} = \{\vInstalledCapacity, \vPower, \vPowerIn, \vPowerOut, \vStorageUnitEnergy, \vPowerFlow, \vLostLoadPower\}$, and lower-level dual variables by $\bm{\Lambda} = \{\dNonNegativeCandidateCapacity, \dSolarBuildLimit, \\\dWindBuildLimit, \dStorageBuildLimit, \dMinPowerOutput, \dMaxPowerOutputExistingThermal, \dMaxPowerOutputCandidateThermal, \dMaxPowerOutputWindExisting, \dMaxPowerOutputWindCandidate, \dMaxPowerOutputSolarExisting,  \dMaxPowerOutputSolarCandidate, \dMaxPowerOutputHydro,  \dNonNegativeCharging, \dNonNegativeDischarging, \dMaxChargingRateExisting,  \dMaxChargingRateCandidate, \dMaxDischargingRateExisting, \\ \dMaxDischargingRateCandidate, \dMaxDischargingRateExisting, \dMaxDischargingRateCandidate, \dNonNegativeStorageEnergy, \dMaxStorageEnergyExisting, \dMaxStorageEnergyCandidate, \dMinStorageEnergyIntervalEnd, \dMaxStorageEnergyIntervalEnd, \dRampRateUp, \dRampRateDown, \dNonNegativeLostLoad, \dMinPowerFlow, \dMaxPowerFlow, \dPowerBalance, \dStorageEnergyTransition\}$.

Constraint (\ref{eqn: non-negative policy variables}) ensures that policy variables are non-negative over the model horizon, while (\ref{eqn: cumulative revenue constraint}) imposes a cumulative revenue constraint up until transition year, $\iYearTransition$. From year $n$ to the end of the model horizon total emissions payments collected in a given year are made to exactly equal total credits paid out, with these revenue neutrality constraints enforced by (\ref{eqn: revenue neutral constraint}). The upper-level objective and constraints given by (\ref{eqn: upper-level objective})--(\ref{eqn: revenue neutral constraint}) can be thought of as taking into account transitional effects when calibrating an emissions abatement policy. In the years immediately following the scheme's introduction the policymaker may run the scheme at a net surplus or deficit each year, so long as cumulative scheme revenue is greater than some amount $\cMinimumCumulativeSchemeRevenue$ by the end of the transitional period. In the years that follow the scheme must run in a revenue neutral manner -- emulating the mechanics of a Refunded Emissions Payment (REP) scheme.

\subsection{Lower-level problem}
The lower-level program seeks to identify the least-cost investment and operating plan for the system over the model's horizon. The structure of the program, in particular treatment of end-of-horizon costs, and the treatment of amortised investment costs, are based on the models presented in REF and REF. The objective functions seeks to minimise the total present value, $\cTotalPresentValue$, of these costs:

% From the system planner's perspective, policy variables are fixed and can be treated as constants. With these policy variables fixed, the lower-level problem can be treated as a linear program, allowing the property of strong-duality to be used when reformulating the bi-level program, as will be discussed in the following sections. The time value of money is also taken into account when computing these

\begin{equation}
	\minimise\limits_{\bm{\Gamma}} \quad \cTotalPresentValue
\end{equation}

The $\cTotalPresentValue$ is comprised of the following expressions, where $\cInvestmentCost$, $\cFixedOperationsMaintenanceCost$, and $\cOperatingCost[\iYear]$ denote the total investment, fixed operations and maintenance, and operating costs for year $\iYear$ respectively:

\begin{align}
\begin{split}
\cTotalPresentValue & = \sum\limits_{\iYear \in \sYears} \cDiscountRate \left[\cInvestmentCost + \cFixedOperationsMaintenanceCost + \cOperatingCost[\iYear] \right] 
+ \cEndOfHorizonCost \\
\end{split}
\label{eqn: total present value expression}
\end{align}

These terms are discounted by $\cDiscountRate$ to take into account the opportunity cost associated with investing at different stages over the model horizon, and allows the present value of all cash-flows to be computed, with the discount rate given by:

\begin{equation}
\cDiscountRate = \frac{1}{(1 + \cInterestRate)^{\iYear}}
\end{equation}

Where $\cInterestRate$ is the interest rate (or weighted average cost of capital). The last term constituting the $\cTotalPresentValue$ expression in (\ref{eqn: total present value expression}) is an end-of-horizon cost.
This term assumes that the operating costs incurred in the last year of the model's horizon occurs in all future years, preventing investment from being biased towards the start of the horizon. It is assumed that this cost will be paid in perpetuity, and can be expressed as:

\begin{equation}
\cEndOfHorizonCost = \frac{\cDiscountRate[\iYearTerminal]}{\cInterestRate} 
\left(
\cOperatingCost[\iYearTerminal] 
+ 
\cFixedOperationsMaintenanceCost[\iYearTerminal] 
\right)
\end{equation}

It is suggested in REF that this concept of an end-of-horizon cost is used within the Australia Energy Market Operator's capacity expansion planning models, and has also been used within other asset expansion planning frameworks [REF, REF]. The following subsections detail the constitute components associated with each expression in (\ref{eqn: total present value expression}).

\subsubsection{Investment cost}
The amortised investment cost is assumed to be paid in perpetuity. This assumes that once a unit reaches the end of its technical life it will be replaced by an identical unit.

\begin{equation}
\cInvestmentCost = \frac{1}{\cInterestRate}\sum\limits_{g\in \sGeneratorsCandidate} \cAmortisationRate  \cCandidateInvestmentCost \vInstalledCapacity
\end{equation}

Where $\cAmortisationRate$ is the amortisation rate of the investment, which depends on the technical life of the unit, $\cAssetLifetime$, and is given by:

\begin{equation}
\cAmortisationRate = \frac{\cInterestRate(1+\cInterestRate)^{\cAssetLifetime}}{(1+\cInterestRate)^{\cAssetLifetime} - 1}
\end{equation}


\subsubsection{Operating costs}

Total operating cost for a given year, $\iYear$, are equal to the total cost for a representative day, $\cOperatingCostScenario$, multiplied by the relative duration of the day for a given year, $\cScenarioDuration$. The concept of relative duration stems from the construction procedure for the set of representative days for each year. A $k$-means clustering algorithm is used to reduce a set of 365 load, hydro, solar, wind, and demand traces into a reduced set of traces that seeks to retain the temporal relationships and correlations between these traces. Reducing these input traces to set of $k$ centroid traces, and assigning each input trace to its closest centroid allows a relative weighting to be assigned to each centroid. Therefore the relative duration, $\cScenarioDuration$, can be considered as the number of days in a year that are represented by the trace. An expression for total operating costs over an entire year can then be formulated as follows:

\begin{equation}
\cOperatingCost[\iYear] = \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \cOperatingCostScenario
\end{equation}

Further decomposing the costs constituting each representative day, $\iScenario$:

\begin{equation}
\cOperatingCostScenario = \cOperatingCostThermal + \cOperatingCostHydro + \cOperatingCostWind + \cOperatingCostSolar + \cOperatingCostStorage + \cOperatingCostLostLoad
\end{equation}

Which finally decomposes by generation cost for each existing and candidate unit, and the cost associated with lost-load:

Thermal generators:
\begin{equation}
	\cOperatingCostThermal = \sum\limits_{\iInterval} \sum\limits_{\iGenerator \in \sGeneratorsThermal} \left[\cMarginalCost + (\cEmissionsIntensity - \vBaseline)\vPermitPrice\right]\vPower\\
\end{equation}

Hydro generators:
\begin{equation}
	\cOperatingCostHydro = \sum\limits_{\iInterval}\sum\limits_{\iGenerator \in \sGeneratorsHydro}\cMarginalCost \vPower
\end{equation}

Wind generators:
\begin{equation}
	\cOperatingCostWind = \sum\limits_{\iInterval}\left[\sum\limits_{\iGenerator \in \sGeneratorsExistingWind} \cMarginalCost \vEnergy + \sum\limits_{\iGenerator \in \sGeneratorsCandidateWind} \left[\cMarginalCost - \vBaseline \vPermitPrice\right] \vPower\right]
\end{equation}

Solar generators:
\begin{equation}
	\cOperatingCostSolar = \sum\limits_{\iInterval}\left[\sum\limits_{\iGenerator \in \sGeneratorsExistingSolar} \cMarginalCost \vEnergy + \sum\limits_{\iGenerator \in \sGeneratorsCandidateSolar} \left[\cMarginalCost - \vBaseline\vPermitPrice\right] \vPower\right]
\end{equation}

Storage units:
\begin{equation}
	\cOperatingCostStorage = \sum\limits_{\iInterval}\sum\limits_{\iGenerator \in \sStorage} \cMarginalCost \vPowerOut
\end{equation}

Value of lost load:
\begin{equation}
	\cOperatingCostLostLoad = \sum\limits_{\iInterval}\sum\limits_{\iZone \in \sZones} \cLostLoadCost \vLostLoadPower
\end{equation}

It is important to note that all existing and candidate thermal generators are assumed to be subject to the emissions abatement policy, while only candidate wind and solar generators would receive a rebate under the scheme. This is broadly in-line with recommendations made in REF, that suggests incumbent renewables be ineligible for credits. The inclusion of incumbent renewables in the scheme would yield the owners of these assets windfall profits, but result in no material emissions abatement.

\subsubsection{Fixed operation and maintenance (FOM) costs}
\begin{equation}
\cFixedOperationsMaintenanceCost = \sum\limits_{\iGenerator \in \sGeneratorsCandidate} \cFixedOperationsMaintenanceCostGenerator \vInstalledCapacityTotal
\end{equation}


\subsubsection{Investment constraints}
Continuous capacity sizing for candidate generators:

\begin{equation}
	- \vInstalledCapacity[\iGenerator,\iYear] \leq 0 \quad (\dNonNegativeCandidateCapacity) \quad \forall \iGenerator \in \sGeneratorsCandidate \quad \forall \iYear \in \sYears
\end{equation}

Build limits for different technologies in each zone:

\begin{equation}
\sum\limits_{\iGenerator \in \sGeneratorsCandidateSolar_{\iZone}} \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias] - \cBuildLimitSolar \leq 0 \quad (\dSolarBuildLimit) \quad \forall \iZone \in \sZones \quad \forall \iYear \in \sYears
\end{equation}

\begin{equation}
\sum\limits_{\iGenerator \in \sGeneratorsCandidateWind_{\iZone}} \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias] - \cBuildLimitWind \leq 0 \quad (\dWindBuildLimit) \quad \forall \iZone \in \sZones \quad \forall \iYear \in \sYears 
\end{equation}

\begin{equation}
	\sum\limits_{\iGenerator \in \sStorageCandidate_{\iZone}}  \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias] - \cBuildLimitStorage \leq 0  \quad (\dStorageBuildLimit) \quad \forall \iZone \in \sZones \quad \forall \iYear \in \sYears
\end{equation}

\subsubsection{Operating constraints}
Minimum power output:
\begin{equation}
	-\vPower + \cPowerOutputMin \leq 0 \quad (\dMinPowerOutput) \quad \forall \iGenerator \in \sGenerators \setminus \sStorage \sScenarioSets
\end{equation}

Total thermal power output:
\begin{equation}
	\vPower - \cPowerOutputMax \left(1 - \cRetirementIndicator\right) \leq 0 \quad (\dMaxPowerOutputExistingThermal) \quad \forall \iGenerator \in \sGeneratorsExistingThermal \sScenarioSets
\end{equation}

\begin{equation}
	\vPower - \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias] \leq 0 \quad (\dMaxPowerOutputCandidateThermal) \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \sScenarioSets
\end{equation}

Total power output from wind generators:
\begin{equation}
	\vPower - \cCapacityFactorWind \cPowerOutputMax[\iGenerator] \left(1 - \cRetirementIndicator\right) \leq 0 \quad (\dMaxPowerOutputWindExisting) \quad \forall \iGenerator \in \sGeneratorsExistingWind \sScenarioSets
\end{equation}

\begin{equation}
	\vPower - \cCapacityFactorWind \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias] \leq 0 \quad (\dMaxPowerOutputWindCandidate) \quad \forall \iGenerator \in \sGeneratorsCandidateWind \sScenarioSets
\end{equation}

Total power output - solar units:
\begin{equation}
	\vPower - \cCapacityFactorSolar \cPowerOutputMax[\iGenerator] \left(1 - \cRetirementIndicator\right) \leq 0 \quad (\dMaxPowerOutputSolarExisting) \quad \forall \iGenerator \in \sGeneratorsExistingSolar \sScenarioSets
\end{equation}

\begin{equation}
	\vPower - \cCapacityFactorSolar \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias] \leq 0 \quad (\dMaxPowerOutputSolarCandidate) \quad \forall \iGenerator \in \sGeneratorsCandidateSolar \sScenarioSets
\end{equation}

Total power output - hydro units (may need to adjust notation for max hydro output):
\begin{equation}
	\vPower - \cPowerOutputHydro \left(1 - \cRetirementIndicator\right) \leq 0 \quad (\dMaxPowerOutputHydro) \quad \forall \iGenerator \in \sGeneratorsHydro \sScenarioSets
\end{equation}

Storage units:
\begin{equation}
	-\vPowerIn \leq 0 \quad (\dNonNegativeCharging) \quad \forall \iGenerator \in \sStorage \sScenarioSets
\end{equation}

\begin{equation}
	-\vPowerOut \leq 0 \quad (\dNonNegativeDischarging) \quad \forall \iGenerator \in \sStorage \sScenarioSets
\end{equation}

\begin{equation}
	\vPowerIn - \cPowerChargingMax \left(1 - \cRetirementIndicator\right) \leq 0 \quad (\dMaxChargingRateExisting) \quad \forall \iGenerator \in \sStorageExisting \sScenarioSets
\end{equation}

\begin{equation}
	\vPowerIn - \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias] \leq 0 \quad (\dMaxChargingRateCandidate) \quad \forall \iGenerator \in \sStorageCandidate \sScenarioSets
\end{equation}

\begin{equation}
	\vPowerOut - \cPowerDischargingMax \left(1 - \cRetirementIndicator\right) \leq 0 \quad (\dMaxDischargingRateExisting) \quad \forall \iGenerator \in \sStorageExisting \sScenarioSets
\end{equation}

\begin{equation}
	\vPowerOut - \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias] \leq 0 \quad (\dMaxDischargingRateCandidate) \quad \forall \iGenerator \in \sStorageCandidate \sScenarioSets
\end{equation}

\begin{equation}
	- \vStorageUnitEnergy \leq 0 \quad (\dNonNegativeStorageEnergy) \quad \forall \iGenerator \in \sStorage \sScenarioSets
\end{equation}

\begin{equation}
	\vStorageUnitEnergy - \cStorageUnitEnergyMax \leq 0 \quad (\dMaxStorageEnergyExisting) \quad \forall \iGenerator \in \sStorageExisting \sScenarioSets
\end{equation}

\begin{equation}
	\vStorageUnitEnergy - \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias] \leq 0 \quad (\dMaxStorageEnergyCandidate) \quad \forall \iGenerator \in \sStorageCandidate \sScenarioSets
\end{equation}

\begin{equation}
	\cStorageUnitEnergyIntervalEndMin - \vStorageUnitEnergy[\iGenerator,\iYear,\iScenario,\iIntervalTerminal]\leq  0 \quad (\dMinStorageEnergyIntervalEnd) \quad \forall \iGenerator \in \sStorage \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios
\end{equation}

\begin{equation}
	\vStorageUnitEnergy[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] - \cStorageUnitEnergyIntervalEndMax \leq  0 \quad (\dMaxStorageEnergyIntervalEnd) \quad \forall \iGenerator \in \sStorage \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios
\end{equation}

\begin{equation}
	- \vStorageUnitEnergy + \vStorageUnitEnergy[\iGenerator,\iYear,\iScenario,\iInterval-1] + \cStorageUnitEfficiencyCharging \vPowerIn - \frac{1}{\cStorageUnitEfficiencyDischarging} \vPowerOut = 0 \quad (\dStorageEnergyTransition) \quad \forall \iGenerator \in \sStorage \sScenarioSets \setminus \{\iIntervalStart\}
\end{equation}

\begin{equation}
	- \vStorageUnitEnergy[\iGenerator,\iYear,\iScenario,\iIntervalStart] + \cStorageEnergyInitial + \cStorageUnitEfficiencyCharging \vPowerIn[\iGenerator,\iYear,\iScenario,\iIntervalStart] - \frac{1}{\cStorageUnitEfficiencyDischarging} \vPowerOut[\iGenerator,\iYear,\iScenario,\iIntervalStart] = 0 \quad (\dStorageEnergyTransition[\iGenerator,\iYear,\iScenario,\iIntervalStart]) \quad \forall \iGenerator \in \sStorage \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios
\end{equation}

Ramp-rate up constraint - thermal and hydro generators:
\begin{equation}
	\vPower - \vPower[\iGenerator,\iYear,\iScenario,\iInterval-1] - \cRampRateUp \leq 0 \quad (\dRampRateUp) \quad \forall \iGenerator \in \sGeneratorsThermal \cup \sGeneratorsHydro \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals \setminus \{\iIntervalStart\}
\end{equation}

\begin{equation}
	\vPower[\iGenerator,\iYear,\iScenario,\iIntervalStart] - \cPowerInitial - \cRampRateUp \leq 0 \quad (\dRampRateUp[\iGenerator,\iYear,\iScenario,\iIntervalStart]) \quad \forall \iGenerator \in \sGeneratorsThermal \cup \sGeneratorsHydro \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios
\end{equation}

Ramp-rate down constraint - thermal and hydro generators:
\begin{equation}
	- \vPower + \vPower[\iGenerator,\iYear,\iScenario,\iInterval-1] - \cRampRateDown \leq 0 \quad (\dRampRateDown) \quad \forall \iGenerator \in \sGeneratorsThermal \cup \sGeneratorsHydro \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals \setminus \{\iIntervalStart\}
\end{equation}

\begin{equation}
- \vPower[\iGenerator,\iYear,\iScenario,\iIntervalStart] + \cPowerInitial - \cRampRateDown \leq 0 \quad (\dRampRateDown[\iGenerator,\iYear,\iScenario,\iIntervalStart]) \quad \forall \iGenerator \in \sGeneratorsThermal \cup \sGeneratorsHydro \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios
\end{equation}

Non-negative lost-load:
\begin{equation}
	- \vLostLoadPower \leq 0 \quad (\dNonNegativeLostLoad) \quad \forall \iZone \in \sZones \sScenarioSets
\end{equation}

Power flow between zones:
\begin{equation}
	\cPowerFlowMin - \vPowerFlow \leq 0 \quad (\dMinPowerFlow) \quad \forall \iLink \in \sLinks \sScenarioSets
\end{equation}

\begin{equation}
	\vPowerFlow - \cPowerFlowMax \leq 0 \quad (\dMaxPowerFlow) \quad \forall \iLink \in \sLinks \sScenarioSets
\end{equation}

Power balance for each zone:
\begin{equation}
\cDemand - \sum\limits_{\iGenerator \in \sGenerators_{\iZone} \setminus \sStorage_{\iZone}} \vPower - \sum\limits_{\iGenerator \in \sStorage_{\iZone}} \left(\vPowerOut - \vPowerIn\right) + \sum\limits_{\iLink \in \sLinks} \cIncidenceMatrix \vPowerFlow - \vLostLoadPower = 0 \quad (\dPowerBalance) \quad \forall \iZone \in \sZones \sScenarioSets
\end{equation}

\subsection{Lagrangian}

\begin{equation}
	\mathcal{L} = g(\bm{u}, \bm{v}, \overline{\bm{x}}) + \bm{\mu}^{T}\bm{c}(\bm{u}) + \bm{\nu}^{T}\bm{d}(\bm{u}) + \bm{\sigma}^{T}\bm{m}(\bm{u}, \bm{v}, \bm{\overline{x}}) + \bm{\zeta}^{T} \bm{n}(\bm{u}, \bm{v}, \bm{\overline{x}})
\end{equation}

Where:

\begin{alignat}{3}
	& && g(\bm{u}, \bm{v}, \overline{\bm{x}}) = \sum\limits_{\iYear \in \sYears} \cDiscountRate  &&  \left[\frac{1}{\cInterestRate} \sum\limits_{g\in \sGeneratorsCandidate} \cAmortisationRate  \cCandidateInvestmentCost \vInstalledCapacity + \sum\limits_{\iGenerator \in \sGeneratorsCandidate} \cFixedOperationsMaintenanceCostGenerator \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias] 
	\right. \nonumber\\ 
	& && + \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \sum\limits_{\iInterval \in \sIntervals} && \left[\sum\limits_{\iGenerator \in \sGeneratorsThermal} \left[\cMarginalCost + (\cEmissionsIntensity - \vBaseline)\vPermitPrice\right]\vPower  + \sum\limits_{\iGenerator \in \sGeneratorsHydro}\cMarginalCost \vPower \right. \nonumber\\
	& && && + \sum\limits_{\iGenerator \in \sGeneratorsExistingWind} \cMarginalCost \vPower + \sum\limits_{\iGenerator \in \sGeneratorsCandidateWind} \left[\cMarginalCost - \vBaseline \vPermitPrice\right] \vPower \nonumber\\
	& && && + \sum\limits_{\iGenerator \in \sGeneratorsExistingSolar} \cMarginalCost \vPower + \sum\limits_{\iGenerator \in \sGeneratorsCandidateSolar} \left[\cMarginalCost - \vBaseline\vPermitPrice\right] \vPower\nonumber\\
	& && && + \sum\limits_{\iGenerator \in \sStorage} \cMarginalCost \vPowerOut \nonumber\\
	& && && \left.\left. + \sum\limits_{\iZone \in \sZones} \cLostLoadCost \vLostLoadPower \right]\right] \nonumber\\
	& && + \frac{\cDiscountRate[\iYearTerminal]}{\cInterestRate}\sum\limits_{\iGenerator \in \sGeneratorsCandidate} \cFixedOperationsMaintenanceCostGenerator \sum\limits_{\iYearAlias \leq \iYearTerminal} \vInstalledCapacity[\iGenerator,\iYearAlias]\\
	& && + \sum\limits_{\iScenario \in \sScenarios} \frac{\cDiscountRate[\iYearTerminal]\cScenarioDuration[\iYearTerminal,\iScenario]}{\cInterestRate} \sum\limits_{\iInterval \in \sIntervals} && \left[\sum\limits_{\iGenerator \in \sGeneratorsThermal} \left[\cMarginalCost[\iGenerator,\iYearTerminal] + (\cEmissionsIntensity - \vBaseline[\iYearTerminal])\vPermitPrice[\iYearTerminal]\right]\vPower[\iGenerator,\iYearTerminal,\iScenario,\iInterval]  + \sum\limits_{\iGenerator \in \sGeneratorsHydro}\cMarginalCost[\iGenerator,\iYearTerminal] \vPower[\iGenerator,\iYearTerminal,\iScenario,\iInterval] \right. \nonumber\\
	& && && + \sum\limits_{\iGenerator \in \sGeneratorsExistingWind} \cMarginalCost[\iGenerator,\iYearTerminal] \vPower[\iGenerator,\iYearTerminal,\iScenario,\iInterval] + \sum\limits_{\iGenerator \in \sGeneratorsCandidateWind} \left[\cMarginalCost[\iGenerator,\iYearTerminal] - \vBaseline[\iYearTerminal] \vPermitPrice[\iYearTerminal]\right] \vPower[\iGenerator,\iYearTerminal,\iScenario,\iInterval] \nonumber\\
	& && && + \sum\limits_{\iGenerator \in \sGeneratorsExistingSolar} \cMarginalCost[\iGenerator,\iYearTerminal] \vPower[\iGenerator,\iYearTerminal,\iScenario,\iInterval] + \sum\limits_{\iGenerator \in \sGeneratorsCandidateSolar} \left[\cMarginalCost[\iGenerator,\iYearTerminal] - \vBaseline[\iYearTerminal]\vPermitPrice[\iYearTerminal]\right] \vPower[\iGenerator,\iYearTerminal,\iScenario,\iInterval]\nonumber\\
	& && && + \sum\limits_{\iGenerator \in \sStorage} \cMarginalCost[\iGenerator,\iYearTerminal] \vPowerOut[\iGenerator,\iYearTerminal,\iScenario,\iInterval] \nonumber\\
	& && && \left.\left. + \sum\limits_{\iZone \in \sZones} \cLostLoadCost \vLostLoadPower[\iZone,\iYearTerminal,\iScenario,\iInterval] \right]\right] \nonumber\\
\end{alignat}

\begin{align}
\begin{split}
\bm{\mu}^{T}\bm{c}(\bm{u}) = & \sum\limits_{\iYear \in \sYears} \sum\limits_{\iGenerator \in \sGeneratorsCandidate} \dNonNegativeCandidateCapacity \left(-\vInstalledCapacity\right)\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iZone \in \sZones} \dSolarBuildLimit \left(\sum\limits_{\iGenerator \in \sGeneratorsCandidateSolar_{\iZone}} \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias]  - \cBuildLimitSolar\right)\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iZone \in \sZones} \dWindBuildLimit \left(\sum\limits_{\iGenerator \in \sGeneratorsCandidateWind_{\iZone}} \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias] - \cBuildLimitWind\right)\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iZone \in \sZones} \dStorageBuildLimit \left(\sum\limits_{\iGenerator \in \sStorageCandidate_{\iZone}} \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias] - \cBuildLimitStorage\right)\\
\end{split}
\end{align}

\begin{align}
		\bm{\sigma}^{T}\bm{m}(\bm{u}, \bm{v}, \bm{\overline{x}}) = & \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGenerators \setminus \sStorage} \dMinPowerOutput \left(-\vPower + \cPowerOutputMin\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsExistingThermal} \dMaxPowerOutputExistingThermal \left(\vPower - \cPowerOutputMax \left(1 - \cRetirementIndicator\right)\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsCandidateThermal} \dMaxPowerOutputCandidateThermal \left(\vPower - \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias]\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsExistingWind} \dMaxPowerOutputWindExisting \left(\vPower - \cCapacityFactorWind \cPowerOutputMax[\iGenerator] \left(1 - \cRetirementIndicator\right) \right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsCandidateWind} \dMaxPowerOutputWindCandidate \left(\vPower - \cCapacityFactorWind \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias]\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsExistingSolar} \dMaxPowerOutputSolarExisting \left(\vPower - \cCapacityFactorSolar \cPowerOutputMax[\iGenerator] \left(1 - \cRetirementIndicator\right)\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsCandidateSolar} \dMaxPowerOutputSolarCandidate \left(\vPower - \cCapacityFactorSolar \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias]\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsHydro} \dMaxPowerOutputHydro \left(\vPower - \cPowerOutputHydro \left(1 - \cRetirementIndicator\right) \right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sStorage} \dNonNegativeCharging \left(-\vPowerIn\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sStorage} \dNonNegativeDischarging \left(-\vPowerOut\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sStorageExisting} \dMaxChargingRateExisting \left(\vPowerIn - \cPowerChargingMax \left(1 - \cRetirementIndicator\right) \right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sStorageCandidate} \dMaxChargingRateCandidate \left(\vPowerIn - \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias]\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sStorageExisting} \dMaxDischargingRateExisting \left(\vPowerOut - \cPowerDischargingMax \left(1 - \cRetirementIndicator\right)\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sStorageCandidate} \dMaxDischargingRateCandidate \left(\vPowerOut - \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias]\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sStorage} \dNonNegativeStorageEnergy \left(- \vStorageUnitEnergy\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sStorageExisting} \dMaxStorageEnergyExisting \left(\vStorageUnitEnergy - \cStorageUnitEnergyMax\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sStorageCandidate} \dMaxStorageEnergyCandidate \left(\vStorageUnitEnergy - \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias]\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iGenerator \in \sStorage} \dMinStorageEnergyIntervalEnd \left(\cStorageUnitEnergyIntervalEndMin - \vStorageUnitEnergy[\iGenerator,\iYear,\iScenario,\iIntervalTerminal]\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iGenerator \in \sStorage} \dMaxStorageEnergyIntervalEnd \left(\vStorageUnitEnergy[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] - \cStorageUnitEnergyIntervalEndMax\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals \setminus \{\iIntervalStart\}} \sum\limits_{\iGenerator \in \sGeneratorsThermal \cup \sGeneratorsHydro} \dRampRateUp \left(\vPower - \vPower[\iGenerator,\iYear,\iScenario,\iInterval-1] - \cRampRateUp\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iGenerator \in \sGeneratorsThermal \cup \sGeneratorsHydro} \dRampRateUp[\iGenerator,\iYear,\iScenario,\iIntervalStart] \left(\vPower[\iGenerator,\iYear,\iScenario,\iIntervalStart] - \cPowerInitial - \cRampRateUp\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals \setminus \{\iIntervalStart\}} \sum\limits_{\iGenerator \in \sGeneratorsThermal \cup \sGeneratorsHydro} \dRampRateDown \left(- \vPower + \vPower[\iGenerator,\iYear,\iScenario,\iInterval-1] - \cRampRateDown\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iGenerator \in \sGeneratorsThermal \cup \sGeneratorsHydro} \dRampRateDown[\iGenerator,\iYear,\iScenario,\iIntervalStart] \left(- \vPower[\iGenerator,\iYear,\iScenario,\iIntervalStart] + \cPowerInitial - \cRampRateDown\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iZone \in \sZones} \dNonNegativeLostLoad \left(- \vLostLoadPower\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iLink \in \sLinks} \dMinPowerFlow \left(\cPowerFlowMin - \vPowerFlow\right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iLink \in \sLinks} \dMaxPowerFlow \left(\vPowerFlow - \cPowerFlowMax\right)\\\nonumber
\end{align}

\begin{align}
	\begin{split}
		\bm{\zeta}^{T} \bm{n}(\bm{u}, \bm{v}, \bm{\overline{x}}) = 	& \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iZone \in \sZones} \dPowerBalance \left(\cDemand - \sum\limits_{\iGenerator \in \sGenerators_{\iZone} \setminus \sStorage_{\iZone}} \vPower - \sum\limits_{\iGenerator \in \sStorage_{\iZone}} \left(\vPowerOut - \vPowerIn\right) + \sum\limits_{\iLink \in \sLinks} \cIncidenceMatrix \vPowerFlow - \vLostLoadPower \right)\\
		& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals \setminus \{\iIntervalStart\}} \sum\limits_{\iGenerator \in \sStorage} \dStorageEnergyTransition \left(-\vStorageUnitEnergy + \vStorageUnitEnergy[\iGenerator,\iYear,\iScenario,\iInterval-1] + \cStorageUnitEfficiencyCharging \vPowerIn - \frac{1}{\cStorageUnitEfficiencyDischarging} \vPowerOut \right)\\
		& + \sum\limits_{\iYear \in \sYears} \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iGenerator \in \sStorage} \dStorageEnergyTransition[\iGenerator,\iYear,\iScenario,\iIntervalStart] \left(-\vStorageUnitEnergy[\iGenerator,\iYear,\iScenario,\iIntervalStart] + \cStorageEnergyInitial + \cStorageUnitEfficiencyCharging \vPowerIn[\iGenerator,\iYear,\iScenario,\iIntervalStart] - \frac{1}{\cStorageUnitEfficiencyDischarging} \vPowerOut[\iGenerator,\iYear,\iScenario,\iIntervalStart] \right)\\
	\end{split}
\end{align}

\subsection{Dual problem}
Define the dual function as follows:

\begin{equation}
	\Lambda = \minimise\limits_{\bm{\mu}, \bm{\nu}, \bm{\sigma}, \bm{\zeta}} \quad \mathcal{L}(\cdot)
\end{equation}

The dual problem can be expressed as:

\begin{equation}
	\maximise\limits_{\bm{\mu}\geq \bm{0}, \bm{\sigma}\geq \bm{0}, \bm{\nu}, \bm{\zeta}} \quad \Lambda
\end{equation}

\subsubsection{Expressions}
Each primal variable within the Lagrangian is factored out to identify a set of constraints that prevent the dual problem from being unbounded.

\newcommand{\sumIntervals}{\sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals}}

Investment decision - candidate thermal:
\begin{align}
	& \sum\limits_{\iYear \in \sYears} \sum\limits_{\iGenerator \in \sGeneratorsCandidateThermal} \vInstalledCapacity \left(\frac{\cDiscountRate}{\cInterestRate} \cAmortisationRate \cCandidateInvestmentCost + \sum\limits_{\iYearAlias \geq \iYear} \cDiscountRate[\iYearAlias] \cFixedOperationsMaintenanceCostGenerator - \dNonNegativeCandidateCapacity + \sum\limits_{\iYearAlias \geq \iYear} \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals} - \dMaxPowerOutputCandidateThermal[\iGenerator,\iYearAlias,\iScenario,\iInterval] + \frac{\cDiscountRate[\iYearTerminal]}{\cInterestRate}\cFixedOperationsMaintenanceCostGenerator\right)\\\nonumber
\end{align}

Investment decision - candidate solar:
\begin{align}
& \sum\limits_{\iYear \in \sYears} \sum\limits_{\iGenerator \in \sGeneratorsCandidateSolar} \vInstalledCapacity \left(\frac{\cDiscountRate}{\cInterestRate} \cAmortisationRate \cCandidateInvestmentCost + \sum\limits_{\iYearAlias \geq \iYear} \left(\cDiscountRate[\iYearAlias] \cFixedOperationsMaintenanceCostGenerator + \dSolarBuildLimit[k(\iGenerator), \iYearAlias] \right) - \dNonNegativeCandidateCapacity 
+ \sum\limits_{\iYearAlias \geq \iYear} \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals} - \cCapacityFactorSolar[\iGenerator,\iYearAlias,\iScenario,\iInterval] \dMaxPowerOutputSolarCandidate[\iGenerator,\iYearAlias,\iScenario,\iInterval] + \frac{\cDiscountRate[\iYearTerminal]}{\cInterestRate}\cFixedOperationsMaintenanceCostGenerator\right)\\\nonumber
\end{align}

Investment decision - candidate wind:
\begin{align}
& \sum\limits_{\iYear \in \sYears} \sum\limits_{\iGenerator \in \sGeneratorsCandidateWind} \vInstalledCapacity \left(\frac{\cDiscountRate}{\cInterestRate} \cAmortisationRate \cCandidateInvestmentCost + \sum\limits_{\iYearAlias \geq \iYear} \left(\cDiscountRate[\iYearAlias] \cFixedOperationsMaintenanceCostGenerator + \dWindBuildLimit[k(\iGenerator), \iYearAlias] \right) - \dNonNegativeCandidateCapacity 
+ \sum\limits_{\iYearAlias \geq \iYear} \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals} - \cCapacityFactorWind[\iGenerator,\iYearAlias,\iScenario,\iInterval] \dMaxPowerOutputWindCandidate[\iGenerator,\iYearAlias,\iScenario,\iInterval] + \frac{\cDiscountRate[\iYearTerminal]}{\cInterestRate}\cFixedOperationsMaintenanceCostGenerator \right)\\\nonumber
\end{align}

Total installed capacity - candidate storage generators:
\begin{align}
& \sum\limits_{\iYear \in \sYears} \sum\limits_{\iGenerator \in \sStorageCandidate} \vInstalledCapacity \left(\frac{\cDiscountRate}{\cInterestRate} \cAmortisationRate \cCandidateInvestmentCost + \sum\limits_{\iYearAlias \geq \iYear}\left(\cDiscountRate[\iYearAlias] \cFixedOperationsMaintenanceCostGenerator + \dStorageBuildLimit[k(\iGenerator),\iYearAlias] \right) - \dNonNegativeCandidateCapacity + \sum\limits_{\iYearAlias \geq \iYear} \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals} \left[- \dMaxChargingRateCandidate[\iGenerator,\iYearAlias,\iScenario,\iInterval] - \dMaxDischargingRateCandidate[\iGenerator,\iYearAlias,\iScenario,\iInterval] - \dMaxStorageEnergyCandidate[\iGenerator,\iYearAlias,\iScenario,\iInterval] \right] + \frac{\cDiscountRate[\iYearTerminal]}{\cInterestRate}\cFixedOperationsMaintenanceCostGenerator\right)\\\nonumber
\end{align}

Existing thermal generator power output:
\begin{align}
	\sum\limits_{\iYear \in \sYears 
		\setminus \{\iYearTerminal\}
	}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals \setminus \{\iIntervalTerminal\}} \sum\limits_{\iGenerator \in \sGeneratorsExistingThermal} \vPower &\left( -\dMinPowerOutput + \dMaxPowerOutputExistingThermal 
	- \dPowerBalance[k(\iGenerator),\iYear,\iScenario,\iInterval] + \cDiscountRate \cScenarioDuration \left[\cMarginalCost + \left(\cEmissionsIntensity - \vBaseline\right)\vPermitPrice \right] \right. \nonumber\\
	& \left. + \dRampRateUp - \dRampRateUp[\iGenerator,\iYear,\iScenario,\iInterval + 1] - \dRampRateDown + \dRampRateDown[\iGenerator,\iYear,\iScenario,\iInterval + 1]
	\right)\\\nonumber
\end{align}

\begin{equation}
	+ \sum\limits_{\iYear \in \sYears 
		\setminus \{\iYearTerminal\}
	}\sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iGenerator \in \sGeneratorsExistingThermal} \vPower[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] \left(-\dMinPowerOutput[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] + \dMaxPowerOutputExistingThermal[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] 
	- \dPowerBalance[k(\iGenerator),\iYear,\iScenario,\iIntervalTerminal] + \cDiscountRate \cScenarioDuration \left[\cMarginalCost + \left(\cEmissionsIntensity - \vBaseline\right)\vPermitPrice \right] + \dRampRateUp[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] - \dRampRateDown[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] \right)\\
\end{equation}

\begin{align}
	+ \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals \setminus \{\iIntervalTerminal\}} \sum\limits_{\iGenerator \in \sGeneratorsExistingThermal} \vPower[\iGenerator,\iYearTerminal,\iScenario,\iInterval] & \left(-\dMinPowerOutput[\iGenerator,\iYearTerminal,\iScenario,\iInterval] + \dMaxPowerOutputExistingThermal[\iGenerator,\iYearTerminal,\iScenario,\iInterval] - \dPowerBalance[k(\iGenerator),\iYearTerminal,\iScenario,\iInterval] + \cDiscountRate[\iYearTerminal] \cScenarioDuration[\iYearTerminal,\iScenario] \left[1 + \frac{1}{\cInterestRate}\right] \left[\cMarginalCost[\iGenerator,\iYearTerminal] + \left(\cEmissionsIntensity - \vBaseline[\iYearTerminal]\right)\vPermitPrice[\iYearTerminal] \right] \right.\nonumber\\
	& \left. \vphantom{1 + \frac{1}{\cInterestRate}} + \dRampRateUp[\iGenerator,\iYearTerminal,\iScenario,\iInterval] - \dRampRateUp[\iGenerator,\iYearTerminal,\iScenario,\iInterval + 1] - \dRampRateDown[\iGenerator,\iYearTerminal,\iScenario,\iInterval] + \dRampRateDown[\iGenerator,\iYearTerminal,\iScenario,\iInterval + 1]
	\right)\nonumber\\
\end{align}

\begin{equation}
	+ \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iGenerator \in \sGeneratorsExistingThermal} \vPower[\iGenerator,\iYearTerminal,\iScenario,\iIntervalTerminal] \left(-\dMinPowerOutput[\iGenerator,\iYearTerminal,\iScenario,\iIntervalTerminal] + \dMaxPowerOutputExistingThermal[\iGenerator,\iYearTerminal,\iScenario,\iIntervalTerminal] - \dPowerBalance[k(\iGenerator),\iYearTerminal,\iScenario,\iIntervalTerminal] + \cDiscountRate[\iYearTerminal] \cScenarioDuration[\iYearTerminal,\iScenario] \left[1 + \frac{1}{\cInterestRate}\right] \left[\cMarginalCost[\iGenerator,\iYearTerminal] + \left(\cEmissionsIntensity - \vBaseline[\iYearTerminal]\right)\vPermitPrice[\iYearTerminal] \right] + \dRampRateUp[\iGenerator,\iYearTerminal,\iScenario,\iIntervalTerminal] - \dRampRateDown[\iGenerator,\iYearTerminal,\iScenario,\iIntervalTerminal] \right)
\end{equation}

Candidate thermal generator power output:
\begin{align}
\sum\limits_{\iYear \in \sYears 
	\setminus \{\iYearTerminal\}
}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals \setminus \{\iIntervalTerminal\}} \sum\limits_{\iGenerator \in \sGeneratorsCandidateThermal} \vPower &\left( -\dMinPowerOutput + \dMaxPowerOutputCandidateThermal 
- \dPowerBalance[k(\iGenerator),\iYear,\iScenario,\iInterval] + \cDiscountRate \cScenarioDuration \left[\cMarginalCost + \left(\cEmissionsIntensity - \vBaseline\right)\vPermitPrice \right] \right. \nonumber\\
& \left. + \dRampRateUp - \dRampRateUp[\iGenerator,\iYear,\iScenario,\iInterval + 1] - \dRampRateDown + \dRampRateDown[\iGenerator,\iYear,\iScenario,\iInterval + 1]
\right)\\\nonumber
\end{align}

\begin{equation}
+ \sum\limits_{\iYear \in \sYears 
	\setminus \{\iYearTerminal\}
}\sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iGenerator \in \sGeneratorsCandidateThermal} \vPower[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] \left(-\dMinPowerOutput[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] + \dMaxPowerOutputCandidateThermal[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] 
- \dPowerBalance[k(\iGenerator),\iYear,\iScenario,\iIntervalTerminal] + \cDiscountRate \cScenarioDuration \left[\cMarginalCost + \left(\cEmissionsIntensity - \vBaseline\right)\vPermitPrice \right] + \dRampRateUp[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] - \dRampRateDown[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] \right)\\
\end{equation}

\begin{align}
+ \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals \setminus \{\iIntervalTerminal\}} \sum\limits_{\iGenerator \in \sGeneratorsCandidateThermal} \vPower[\iGenerator,\iYearTerminal,\iScenario,\iInterval] & \left(-\dMinPowerOutput[\iGenerator,\iYearTerminal,\iScenario,\iInterval] + \dMaxPowerOutputCandidateThermal[\iGenerator,\iYearTerminal,\iScenario,\iInterval] - \dPowerBalance[k(\iGenerator),\iYearTerminal,\iScenario,\iInterval] + \cDiscountRate[\iYearTerminal] \cScenarioDuration[\iYearTerminal,\iScenario] \left[1 + \frac{1}{\cInterestRate}\right] \left[\cMarginalCost[\iGenerator,\iYearTerminal] + \left(\cEmissionsIntensity - \vBaseline[\iYearTerminal]\right)\vPermitPrice[\iYearTerminal] \right] \right.\nonumber\\
& \left. \vphantom{1 + \frac{1}{\cInterestRate}} + \dRampRateUp[\iGenerator,\iYearTerminal,\iScenario,\iInterval] - \dRampRateUp[\iGenerator,\iYearTerminal,\iScenario,\iInterval + 1] - \dRampRateDown[\iGenerator,\iYearTerminal,\iScenario,\iInterval] + \dRampRateDown[\iGenerator,\iYearTerminal,\iScenario,\iInterval + 1]
\right)\nonumber\\
\end{align}

\begin{equation}
+ \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iGenerator \in \sGeneratorsCandidateThermal} \vPower[\iGenerator,\iYearTerminal,\iScenario,\iIntervalTerminal] \left(-\dMinPowerOutput[\iGenerator,\iYearTerminal,\iScenario,\iIntervalTerminal] + \dMaxPowerOutputCandidateThermal[\iGenerator,\iYearTerminal,\iScenario,\iIntervalTerminal] - \dPowerBalance[k(\iGenerator),\iYearTerminal,\iScenario,\iIntervalTerminal] + \cDiscountRate[\iYearTerminal] \cScenarioDuration[\iYearTerminal,\iScenario] \left[1 + \frac{1}{\cInterestRate}\right] \left[\cMarginalCost[\iGenerator,\iYearTerminal] + \left(\cEmissionsIntensity - \vBaseline[\iYearTerminal]\right)\vPermitPrice[\iYearTerminal] \right] + \dRampRateUp[\iGenerator,\iYearTerminal,\iScenario,\iIntervalTerminal] - \dRampRateDown[\iGenerator,\iYearTerminal,\iScenario,\iIntervalTerminal] \right)
\end{equation}

Existing wind generator power output:
\begin{align}
	& \sum\limits_{\iYear \in \sYears 
		\setminus \{\iYearTerminal\}
	}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsExistingWind} \vPower\left(-\dMinPowerOutput + \dMaxPowerOutputWindExisting
	- \dPowerBalance[k(\iGenerator),\iYear,\iScenario,\iInterval] + \cDiscountRate \cScenarioDuration\cMarginalCost
	\right)\nonumber\\
	& + \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsExistingWind} \vPower[\iGenerator,\iYearTerminal,\iScenario,\iInterval] \left(-\dMinPowerOutput[\iGenerator,\iYearTerminal,\iScenario,\iInterval] + \dMaxPowerOutputWindExisting[\iGenerator,\iYearTerminal,\iScenario,\iInterval] - \dPowerBalance[k(\iGenerator),\iYearTerminal,\iScenario,\iInterval] + \cDiscountRate[\iYearTerminal] \cScenarioDuration[\iYearTerminal,\iScenario] \left[1 + \frac{1}{\cInterestRate}\right] \cMarginalCost \right)\\\nonumber
\end{align}

Candidate wind generator power output:
\begin{align}
	& \sum\limits_{\iYear \in \sYears 
		\setminus \{\iYearTerminal\}
	}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsCandidateWind} \vPower\left(-\dMinPowerOutput + \dMaxPowerOutputWindCandidate 
	- \dPowerBalance[k(\iGenerator),\iYear,\iScenario,\iInterval] + \cDiscountRate \cScenarioDuration \left[\cMarginalCost - \vBaseline\vPermitPrice \right]
	\right) \nonumber\\
	& + \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsCandidateWind} \vPower[\iGenerator,\iYearTerminal,\iScenario,\iInterval] \left(-\dMinPowerOutput[\iGenerator,\iYearTerminal,\iScenario,\iInterval] + \dMaxPowerOutputWindCandidate[\iGenerator,\iYearTerminal,\iScenario,\iInterval] - \dPowerBalance[k(\iGenerator),\iYearTerminal,\iScenario,\iInterval] + \cDiscountRate[\iYearTerminal] \cScenarioDuration[\iYearTerminal,\iScenario] \left[1 + \frac{1}{\cInterestRate}\right] \left[\cMarginalCost[\iGenerator,\iYearTerminal] - \vBaseline[\iYearTerminal]\vPermitPrice[\iYearTerminal] \right] \right)\nonumber\\
\end{align}

Existing solar generator power output:
\begin{align}
	& \sum\limits_{\iYear \in \sYears 
		\setminus \{\iYearTerminal\}
	}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsExistingSolar} \vPower\left(-\dMinPowerOutput + \dMaxPowerOutputSolarExisting 
	- \dPowerBalance[k(\iGenerator),\iYear,\iScenario,\iInterval] + \cDiscountRate \cScenarioDuration\cMarginalCost
	\right) \nonumber\\
	& + \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsExistingSolar} \vPower[\iGenerator,\iYearTerminal,\iScenario,\iInterval] \left(-\dMinPowerOutput[\iGenerator,\iYearTerminal,\iScenario,\iInterval] + \dMaxPowerOutputSolarExisting[\iGenerator,\iYearTerminal,\iScenario,\iInterval] - \dPowerBalance[k(\iGenerator),\iYearTerminal,\iScenario,\iInterval] + \cDiscountRate[\iYearTerminal] \cScenarioDuration[\iYearTerminal,\iScenario] \left[1 + \frac{1}{\cInterestRate}\right] \cMarginalCost \right)\\
\end{align}

Candidate solar generator power output:
\begin{align}
	& \sum\limits_{\iYear \in \sYears 
		\setminus \{\iYearTerminal\}
	}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsCandidateSolar} \vPower \left(-\dMinPowerOutput + \dMaxPowerOutputSolarCandidate 
	- \dPowerBalance[k(\iGenerator),\iYear,\iScenario,\iInterval] + \cDiscountRate \cScenarioDuration \left[\cMarginalCost - \vBaseline\vPermitPrice \right]
	\right) \nonumber\\
	& + \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsCandidateSolar} \vPower[\iGenerator,\iYearTerminal,\iScenario,\iInterval] \left(-\dMinPowerOutput[\iGenerator,\iYearTerminal,\iScenario,\iInterval] + \dMaxPowerOutputSolarCandidate[\iGenerator,\iYearTerminal,\iScenario,\iInterval] - \dPowerBalance[k(\iGenerator),\iYearTerminal,\iScenario,\iInterval] + \cDiscountRate[\iYearTerminal] \cScenarioDuration[\iYearTerminal,\iScenario] \left[1 + \frac{1}{\cInterestRate}\right] \left[\cMarginalCost[\iGenerator,\iYearTerminal] - \vBaseline[\iYearTerminal]\vPermitPrice[\iYearTerminal] \right] \right)\nonumber\\
\end{align}

Existing hydro generator power output:
\begin{equation}
\sum\limits_{\iYear \in \sYears \setminus \{\iYearTerminal\}}\sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals \setminus \{\iIntervalTerminal\}} \sum\limits_{\iGenerator \in \sGeneratorsHydro} \vPower\left(-\dMinPowerOutput + \dMaxPowerOutputHydro - \dPowerBalance[k(\iGenerator),\iYear,\iScenario,\iInterval] + \cDiscountRate \cScenarioDuration\cMarginalCost + \dRampRateUp - \dRampRateUp[\iGenerator,\iYear,\iScenario,\iInterval + 1] - \dRampRateDown + \dRampRateDown[\iGenerator,\iYear,\iScenario,\iInterval + 1]
\right)
\end{equation}

\begin{equation}
+ \sum\limits_{\iYear \in \sYears \setminus \{\iYearTerminal\}}\sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iGenerator \in \sGeneratorsHydro} \vPower[\iGenerator,\iYear,\iScenario,\iIntervalTerminal]\left(-\dMinPowerOutput[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] + \dMaxPowerOutputHydro[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] - \dPowerBalance[k(\iGenerator),\iYear,\iScenario,\iIntervalTerminal] + \cDiscountRate \cScenarioDuration \cMarginalCost + \dRampRateUp[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] - \dRampRateDown[\iGenerator,\iYear,\iScenario,\iIntervalTerminal]
\right)
\end{equation}

\begin{equation}
+ \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals \setminus \{\iIntervalTerminal\}} \sum\limits_{\iGenerator \in \sGeneratorsHydro} \vPower[\iGenerator,\iYearTerminal,\iScenario,\iInterval] \left(-\dMinPowerOutput[\iGenerator,\iYearTerminal,\iScenario,\iInterval] + \dMaxPowerOutputHydro[\iGenerator,\iYearTerminal,\iScenario,\iInterval] - \dPowerBalance[k(\iGenerator),\iYearTerminal,\iScenario,\iInterval] + \cDiscountRate[\iYearTerminal] \cScenarioDuration[\iYearTerminal,\iScenario] \left[1 + \frac{1}{\cInterestRate}\right] \cMarginalCost[\iGenerator,\iYearTerminal] + \dRampRateUp[\iGenerator,\iYearTerminal,\iScenario,\iInterval] - \dRampRateUp[\iGenerator,\iYearTerminal,\iScenario,\iInterval + 1] - \dRampRateDown[\iGenerator,\iYearTerminal,\iScenario,\iInterval] + \dRampRateDown[\iGenerator,\iYearTerminal,\iScenario,\iInterval + 1]
\right)
\end{equation}

\begin{equation}
+ \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iGenerator \in \sGeneratorsHydro} \vPower[\iGenerator,\iYearTerminal,\iScenario,\iIntervalTerminal] \left(-\dMinPowerOutput[\iGenerator,\iYearTerminal,\iScenario,\iIntervalTerminal] + \dMaxPowerOutputHydro[\iGenerator,\iYearTerminal,\iScenario,\iIntervalTerminal] - \dPowerBalance[k(\iGenerator),\iYearTerminal,\iScenario,\iIntervalTerminal] + \cDiscountRate[\iYearTerminal] \cScenarioDuration[\iYearTerminal,\iScenario] \left[1 + \frac{1}{\cInterestRate}\right] \cMarginalCost[\iGenerator,\iYearTerminal] + \dRampRateUp[\iGenerator,\iYearTerminal,\iScenario,\iIntervalTerminal] - \dRampRateDown[\iGenerator,\iYearTerminal,\iScenario,\iIntervalTerminal]
\right)
\end{equation}

Existing storage unit charging power:
\begin{align}
	& \sum\limits_{\iYear \in \sYears} \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals 
	} \sum\limits_{\iGenerator \in \sStorageExisting} \vPowerIn \left( - \dNonNegativeCharging + \dMaxChargingRateExisting + \dPowerBalance[k(\iGenerator),\iYear,\iScenario,\iInterval] + \cStorageUnitEfficiencyCharging\dStorageEnergyTransition 
	 \right) \nonumber\\
\end{align}

Candidate storage unit charging power:
\begin{align}
	& \sum\limits_{\iYear \in \sYears} \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals 
	} \sum\limits_{\iGenerator \in \sStorageCandidate} \vPowerIn \left( - \dNonNegativeCharging + \dMaxChargingRateCandidate + \dPowerBalance[k(\iGenerator),\iYear,\iScenario,\iInterval] + \cStorageUnitEfficiencyCharging\dStorageEnergyTransition
	\right)\nonumber\\
\end{align}

%p_out
Existing storage unit discharging power:
\begin{align}
	& \sum\limits_{\iYear \in \sYears \setminus \{\iYearTerminal\}}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals 
	} \sum\limits_{\iGenerator \in \sStorageExisting} \vPowerOut \left( - \dNonNegativeDischarging + \dMaxDischargingRateExisting - \dPowerBalance[k(\iGenerator),\iYear,\iScenario,\iInterval] - \frac{1}{\cStorageUnitEfficiencyDischarging} \dStorageEnergyTransition + \cDiscountRate \cScenarioDuration \cMarginalCost \right) \nonumber\\
	& + \sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals 
} \sum\limits_{\iGenerator \in \sStorageExisting} \vPowerOut[\iGenerator,\iYearTerminal,\iScenario,\iInterval] \left( - \dNonNegativeDischarging[\iGenerator,\iYearTerminal,\iScenario,\iInterval] + \dMaxDischargingRateExisting[\iGenerator,\iYearTerminal,\iScenario,\iInterval] - \dPowerBalance[k(\iGenerator),\iYearTerminal,\iScenario,\iInterval] - \frac{1}{\cStorageUnitEfficiencyDischarging} \dStorageEnergyTransition[\iGenerator,\iYearTerminal,\iScenario,\iInterval] + \cDiscountRate[\iYearTerminal] \cScenarioDuration[\iYearTerminal,\iScenario] \left[1 + \frac{1}{\cInterestRate}\right] \cMarginalCost[\iGenerator,\iYearTerminal] \right) \nonumber\\
\end{align}

Candidate storage unit discharging power:
\begin{align}
	& \sum\limits_{\iYear \in \sYears \setminus \{\iYearTerminal\}}\sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals 
	} \sum\limits_{\iGenerator \in \sStorageCandidate} \vPowerOut \left( - \dNonNegativeDischarging + \dMaxDischargingRateCandidate - \dPowerBalance[k(\iGenerator),\iYear,\iScenario,\iInterval] - \frac{1}{\cStorageUnitEfficiencyDischarging} \dStorageEnergyTransition + \cDiscountRate \cScenarioDuration \cMarginalCost \right) \nonumber \\ 
	& + \sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals 
} \sum\limits_{\iGenerator \in \sStorageCandidate} \vPowerOut[\iGenerator,\iYearTerminal,\iScenario,\iInterval] \left( - \dNonNegativeDischarging[\iGenerator,\iYearTerminal,\iScenario,\iInterval] + \dMaxDischargingRateCandidate[\iGenerator,\iYearTerminal,\iScenario,\iInterval] - \dPowerBalance[k(\iGenerator),\iYearTerminal,\iScenario,\iInterval] - \frac{1}{\cStorageUnitEfficiencyDischarging} \dStorageEnergyTransition[\iGenerator,\iYearTerminal,\iScenario,\iInterval] + \cDiscountRate[\iYearTerminal] \cScenarioDuration[\iYearTerminal,\iScenario] \left[1 + \frac{1}{\cInterestRate}\right] \cMarginalCost[\iGenerator,\iYearTerminal] \right) \nonumber\\
\end{align}

Existing storage unit energy:
\begin{align}
	& \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals \setminus \{\iIntervalTerminal\}} \sum\limits_{\iGenerator \in \sStorageExisting} \vStorageUnitEnergy \left(- \dNonNegativeStorageEnergy + \dMaxStorageEnergyExisting - \dStorageEnergyTransition + \dStorageEnergyTransition[\iGenerator,\iYear,\iScenario,\iInterval+1] \right)\\
	& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iGenerator \in \sStorageExisting} \vStorageUnitEnergy[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] \left(- \dNonNegativeStorageEnergy[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] + \dMaxStorageEnergyExisting[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] - \dStorageEnergyTransition[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] - \dMinStorageEnergyIntervalEnd + \dMaxStorageEnergyIntervalEnd \right)\\
\end{align}

Candidate storage unit energy:
\begin{align}
	& \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals \setminus \{\iIntervalTerminal\}} \sum\limits_{\iGenerator \in \sStorageCandidate} \vStorageUnitEnergy \left(- \dNonNegativeStorageEnergy + \dMaxStorageEnergyCandidate - \dStorageEnergyTransition + \dStorageEnergyTransition[\iGenerator,\iYear,\iScenario,\iInterval+1] \right)\\
	& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iGenerator \in \sStorageCandidate} \vStorageUnitEnergy[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] \left(- \dNonNegativeStorageEnergy[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] + \dMaxStorageEnergyCandidate[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] - \dStorageEnergyTransition[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] - \dMinStorageEnergyIntervalEnd + \dMaxStorageEnergyIntervalEnd \right)\\
\end{align}

Load shedding (power):
\begin{align}
	& \sum\limits_{\iYear \in \sYears 
		\setminus \{\iYearTerminal\}
	} \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iZone \in \sZones} \vLostLoadPower \left(- \dNonNegativeLostLoad - \dPowerBalance + \cDiscountRate \cScenarioDuration \cLostLoadCost\right)\\
	& + \sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iZone \in \sZones} \vLostLoadPower[\iZone,\iYearTerminal,\iScenario,\iInterval] \left(- \dNonNegativeLostLoad[\iZone,\iYearTerminal,\iScenario,\iInterval] - \dPowerBalance[\iZone,\iYearTerminal,\iScenario,\iInterval] + \cDiscountRate[\iYearTerminal] \cScenarioDuration[\iYearTerminal,\iScenario] \left[1 + \frac{1}{\cInterestRate}\right] \cLostLoadCost\right)\\
\end{align}

Powerflow:
\begin{equation}
	\sumIntervals \sum\limits_{\iLink \in \sLinks} \vPowerFlow \left(-\dMinPowerFlow + \dMaxPowerFlow + \cIncidenceMatrix[g(\iLink), \iLink] \dPowerBalance[g(\iLink),\iYear,\iScenario,\iInterval] + \cIncidenceMatrix[h(\iLink), \iLink] \dPowerBalance[h(\iLink),\iYear,\iScenario,\iInterval]\right)
\end{equation}

Dual objective:

\begin{align}
\textrm{OBJ}_{d} =  & \sum\limits_{\iYear \in \sYears} \sum\limits_{\iZone \in \sZones} \left[- \dSolarBuildLimit \cBuildLimitSolar - \dWindBuildLimit \cBuildLimitWind 
- \dStorageBuildLimit \cBuildLimitStorage
\right]\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGenerators \setminus \sStorage} \dMinPowerOutput \cPowerOutputMin\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsExistingThermal} - \dMaxPowerOutputExistingThermal \cPowerOutputMax[\iGenerator] \left(1 - \cRetirementIndicator\right)\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsExistingWind} - \dMaxPowerOutputWindExisting \cCapacityFactorWind \cPowerOutputMax[\iGenerator] \left(1 - \cRetirementIndicator\right)\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsExistingSolar} - \dMaxPowerOutputSolarExisting \cCapacityFactorSolar \cPowerOutputMax[\iGenerator] \left(1 - \cRetirementIndicator\right)\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsHydro} - \dMaxPowerOutputHydro \cPowerOutputHydro \left(1 - \cRetirementIndicator\right)\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sStorageExisting} - \dMaxChargingRateExisting \cPowerChargingMax \left(1 - \cRetirementIndicator\right)\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sStorageExisting} - \dMaxDischargingRateExisting \cPowerDischargingMax \left(1 - \cRetirementIndicator\right)\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sStorageExisting} - \dMaxStorageEnergyExisting \cStorageUnitEnergyMax\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iGenerator \in \sStorage} \dMinStorageEnergyIntervalEnd \cStorageUnitEnergyIntervalEndMin\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iGenerator \in \sStorage} - \dMaxStorageEnergyIntervalEnd \cStorageUnitEnergyIntervalEndMax\\
%
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsThermal \cup \sGeneratorsHydro} - \dRampRateUp \cRampRateUp\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iGenerator \in \sGeneratorsThermal \cup \sGeneratorsHydro} - \dRampRateUp[\iGenerator,\iYear,\iScenario,\iIntervalStart] \cPowerInitial\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsThermal \cup \sGeneratorsHydro} - \dRampRateDown \cRampRateDown\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios} \sum\limits_{\iGenerator \in \sGeneratorsThermal \cup \sGeneratorsHydro} \dRampRateDown[\iGenerator,\iYear,\iScenario,\iIntervalStart] \cPowerInitial\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iLink \in \sLinks} \dMinPowerFlow \cPowerFlowMin\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iLink \in \sLinks} - \dMaxPowerFlow \cPowerFlowMax\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iZone \in \sZones} \dPowerBalance \cDemand\\
& + \sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios}\sum\limits_{\iGenerator \in \sStorage} \dStorageEnergyTransition[\iGenerator,\iYear,\iScenario,\iIntervalStart] \cStorageEnergyInitial\\
\end{align}

\section{Notation}
\renewcommand*{\arraystretch}{1.3}
\begin{longtable}{ p{.09\textwidth}  p{.75\textwidth}}
	\textbf{Symbol} & \textbf{Description}\\
	\hline\hline
	\multicolumn{2}{l}{\textbf{Indices}}\\
	$\iGenerator$ & Generator\\ 
	$\iYear$ & Year\\
	$\iYearAlias$ & Year alias\\
	$\iYearTerminal$ & Final year in model horizon\\
	$\iScenario$ & Scenario\\
	$\iScenarioAlias$ & Scenario alias\\
	$\iInterval$ & Interval\\
	$\iIntervalAlias$ & Interval alias\\
	$\iIntervalTerminal$ & Final interval\\
	$\iZone$ & NEM zone\\
	$\iRegion$ & NEM region\\
	$\iLink$ & Link connecting adjacent NEM zones\\
	& \\
	\multicolumn{2}{l}{\textbf{Sets}}\\
	$\sGenerators$ & All generators\\
	$\sGeneratorsExisting$ & Existing generators\\
	$\sGeneratorsExistingThermal$ & Existing thermal generators\\
	$\sGeneratorsExistingWind$ & Existing wind units\\
	$\sGeneratorsExistingSolar$ & Existing solar units\\
	$\sGeneratorsCandidate$ & Candidate generators\\
	$\sGeneratorsCandidateThermal$ & Candidate thermal generators\\
	$\sGeneratorsCandidateWind$ & Candidate wind units\\
	$\sGeneratorsCandidateSolar$ & Candidate solar units\\
	$\sGeneratorsThermal$ & All thermal generators\\
	$\sGeneratorsHydro$ & Hydro generators\\
	$\sStorage$ & All storage units\\
	$\sStorageExisting$ & Existing storage units\\
	$\sStorageCandidate$ & Candidate storage units\\
	$\sYears$ & Years in model horizon\\
	$\sScenarios$ & Operating scenarios\\
	$\sIntervals$ & Time intervals\\
	$\sZones$ & NEM zones\\
	$\sRegions$ & NEM regions\\
	$\sLinks$ & Links connecting NEM zones\\
	$\sScenariosYear$ & Operating scenarios constituting with year $\iYear$\\
	& \\
	\multicolumn{2}{l}{\textbf{Variables}}\\
	$\vBaseline$ & Emissions intensity baseline [tCO$_{2}$/MWh]\\
	$\vPermitPrice$ & Permit price [\$/tCO$_{2}$]\\
	$\vPower$ & Generator power output [MW]\\
	$\vPowerIn$ & Storage unit charging power [MW]\\
	$\vPowerOut$ & Storage unit discharging power [MW]\\
	$\vEnergy$ & Energy output [MWh]\\
	$\vStorageUnitEnergy$ & Energy within storage unit [MWh]\\
	$\vLostLoadPower$ & Lost load power [MW]\\
	$\vLostLoadEnergy$ & Lost load energy [MWh]\\
	$\vPowerFlow$ & Powerflow over link connecting adjacent NEM zones [MW]\\
	$\vInstalledCapacity$ & Capacity installed in year $\iYear$ [MW]\\
	$\vInstalledCapacityTotal$ & Total capacity available in year $\iYear$ [MW]\\
	& \\
	\multicolumn{2}{l}{\textbf{Parameters}}\\
	$\cObjectiveFunction$ & Total cost over model horizon [\$]\\
	$\cTotalPresentValue$ & Total present value of operating, investment, and FOM costs [\$]\\
	$\cInvestmentCost$ & Total investment cost [\$]\\
	$\cFixedOperationsMaintenanceCost$ & Total fixed operations and maintenance cost for year $\iYear$ [\$]\\
	$\cEmissionsViolationTotalCost$ & Cost of violating emissions target [\$]\\
	$\cOperatingCostScenario$ & Total cost for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCost$ & Total operating cost for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostThermal$ & Cost to operate thermal units for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostHydro$ & Cost to operate hydro units for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostWind$ & Cost to operate wind units for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostSolar$ & Cost to operate solar units for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostStorage$ & Cost to operate storage units for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostLostLoad$ & Lost load cost [\$]\\
	$\cCandidateInvestmentCost$ & Candidate unit investment cost [\$/MW]\\
	$\cLostLoadCost$ & Lost load penalty [\$/MWh]\\
	$\cFixedOperationsMaintenanceCostGenerator$ & Fixed operations and maintenance cost for generator $\iGenerator$ [\$]\\
	$\cEmissionsTargetViolationPenalty$ & Emissions target violation penalty [\$/tCO$_{2}$]\\
	$\cMarginalCost$ & Short-run marginal cost [\$/MWh]\\
	$\cAmortisationRate$ & Amorisation rate [--]\\
	$\cInterestRate$ & Interest rate (weighted average cost of capital) [--]\\
	$\cAssetLifetime$ & Asset lifetime [years]\\
	$\cScenarioDuration$ & Scenario duration [h]\\
	$\cRetirementIndicator$ & Retirement indicator [--]\\
	$\cEmissionsIntensity$ & Emissions intensity for generator $\iGenerator$\\
	$\cPowerOutputMax$ & Maximum power output [MW]\\
	$\cPowerOutputMin$ & Minimum power output [MW]\\
	$\cPowerOutputHydro$ & Hydro power output [MW]\\
	$\cRampRateUp$ & Ramp rate up (normal operation) [MW/h]\\
	$\cRampRateDown$ & Ramp down up (normal operation) [MW/h]\\
	$\cPowerChargingMax$ & Storage unit maximum charging power [MW]\\
	$\cPowerDischargingMax$ & Storage unit maximum discharging power [MW]\\
	$\cStorageUnitEnergyMax$ & Storage unit maximum energy capacity [MWh]\\
	$\cStorageUnitEnergyIntervalEndMax$ & Storage unit maximum energy at end of operating scenario [MWh]\\
	$\cStorageUnitEnergyIntervalEndMin$ & Storage unit minimum energy at end of operating scenario [MWh]\\
	$\cStorageUnitEfficiencyCharging$ & Storage unit charging efficiency [--]\\
	$\cStorageUnitEfficiencyDischarging$ & Storage unit discharging efficiency [--]\\
	$\cDemand$ & Demand [MW]\\
	$\cReserveUpRequirement$ & Minimum up reserve requirement [MW]\\
	$\cCapacityFactorWind$ & Capacity factor for wind units [--]\\
	$\cCapacityFactorSolar$ & Capacity factor for solar units [--]\\
	$\cBuildLimitWind$ & Build limit for wind units in zone $\iZone$ [MW]\\
	$\cBuildLimitSolar$ & Build limit for solar units in zone $\iZone$ [MW]\\
	$\cBuildLimitStorage$ & Build limit for storage units in zone $\iZone$ [MW]\\
	$\cIncidenceMatrix$ & Network incidence matrix [--]\\
	$\cPowerFlowMin$ & Minimum powerflow over link $\iLink$ [MW]\\
	$\cPowerFlowMax$ & Maximum powerflow over link $\iLink$ [MW]\\
	$\cEmissionsTotal$ & Total emissions [tCO$_{2}$]\\
	$\cEmmissionsCumulativeTarget$ & Cumulative emissions target [tCO$_{2}$]\\
	$\cSchemeRevenueCumulativeTarget$ & Cumulative scheme revenue target [\$]\\
	\hline
	\caption{Notation}
\end{longtable}

\section{Price setting algorithm}
Price targeting objectives can be achieved by first identifying price setting generators, and which then allows nodal prices to be parametrised as a function of policy variables (namely the emissions intensity baseline). dispatch interval and NEM zone, the generator that sets the price for that zone is identified. This is accomplished by observing the price for that zone, given by the dual variable of the power balance constraint, and comparing this with the short-run marginal costs of all generators within the network. 

\begin{equation}
\iGenerator^{\star}_{\iZone,\iYear,\iScenario,\iInterval} = \arg\min \left(\norm{\mathbf{c}(\mathbf{\iGenerator}, \iYear) - \dPowerBalance}_{1}\right)
\end{equation}

The marginal cost of each generator is given by:

\begin{equation}
c(\iGenerator, \iYear) = A_{\iGenerator} + \left(\cEmissionsIntensity - \vBaseline\right) \vPermitPrice
\end{equation}

By knowing the price setting generator, the marginal price for a given zone and dispatch interval can be approximated based off of the price setting generator's marginal cost function.

\begin{equation}
\hat{\dPowerBalance[]}_{\iZone,\iYear,\iScenario,\iInterval} = A_{\iGenerator^{\star}} + \left(\cEmissionsIntensity[\iGenerator^{\star}] - \vBaseline\right) \vPermitPrice
\end{equation}

Approximation for total revenue over all dispatch intervals in a given year:

\begin{equation}
\mathrm{REVENUE}_{\iYear} = \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \sum\limits_{\iInterval \in \sIntervals}\sum\limits_{\iZone \in \sZones} \hat{\dPowerBalance[]}_{\iZone,\iYear,\iScenario,\iInterval} \cDemand
\end{equation}

Total demand in a given year:

\begin{equation}
\mathrm{DEMAND}_{\iYear} = \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \sum\limits_{\iInterval \in \sIntervals}\sum\limits_{\iZone \in \sZones} \cDemand
\end{equation}

Average price:

\begin{equation}
\mathrm{PRICE}_{\iYear} = \frac{\mathrm{REVENUE}_{\iYear}}{\mathrm{DEMAND}_{\iYear}}
\end{equation}

Price targeting objective:
\begin{equation}
\mathrm{OBJ} = \sum\limits_{\iYear \in \sYears} \norm{\mathrm{PRICE}_{\iYear-1} - \mathrm{PRICE}_{\iYear}}_{1}
\end{equation}

Note that in the first year $\iYear - 1$ is not defined. In this year $\mathrm{PRICE}_{\iYear-1}$ is set equal to the price arising in the first year of the model horizon under the business-as-usual case.

Scheme revenue obtained for a given year. Note that power output is fixed to the value obtained in the carbon tax program. Changing the baseline's value should have no impact on the merit order, and by extension power output from individual generators:

\begin{equation}
R_{\iYear} = \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGenerators} \left(\cEmissionsIntensity - \vBaseline \right) \vPermitPrice \hat{\vPower[]}_{\iGenerator,\iYear,\iScenario,\iInterval}
\end{equation}

Revenue neutrality constraint (entire model horizon):
\begin{equation}
\sum\limits_{\iYear \in \sYears} R_{\iYear} = 0
\end{equation}

Revenue neutrality constraint (up to transition year):
\begin{equation}
\sum\limits_{\iYear \in \bar{\sYears}} R_{\iYear} = 0
\end{equation}

Cumulative revenue constraint lower-bound:
\begin{equation}
\sum\limits_{\iYear=\iYearStart}^{\iYearAlias} R_{\iYear} \geq \underline{R} \quad \forall \iYearAlias \in \left[\iYearStart, \iYearStart + 1, \ldots, \iYearTerminal \right] 
\end{equation}

\section{Cases}
\subsection{Business-as-usual}
This case serves as a benchmark. The permit price and baseline are set = 0 for all years.

\subsection{Carbon tax}
A carbon tax of 40 \$/MWh is imposed for all years of the model horizon. The baseline = 0 for all years.

\subsection{Refunded Emissions Payment Scheme}
A carbon price of 40 \$/MWh is imposed for all years of the model horizon. The revenue collected in each year is refunded to generators in proportion to their output. Operationally, this is the same as establishing an emissions intensity baseline equal to the average emissions intensity of energy falling under the scheme's remit. This case is solved first taking the carbon tax solution, and identifying the average emissions intensity from regulated generators. The baselines are then set equal to these emissions intensity values for each year in the model horizon. The primal program is re-solved. If the difference in installed capacity is sufficiently small between this new solution and the carbon tax case, then stop, else compute the new average emissions intensities, update the baselines and re-solve.

\subsection{Price smoothing - revenue neutrality over entire horizon}
A carbon price of 40 \$/MWh is imposed, with the baselines initially set equal to the average emissions intensities of regulated generators. Information from the primal program is used to solve an auxiliary program that calibrates the emissions intensity baseline. The baselines are updated and the model re-solved. If the max difference between the capacity sizing variable solution is sufficiently close to that obtained in the previous iteration, and the price setting generators have not changed, end, else repeat from the step where the auxiliary program is solved.

\subsection{Price smoothing - revenue neutrality over entire horizon with lower cumulative revenue constraint}
A carbon price of 40 \$/MWh is imposed. Scheme revenue is made to be neutral over the model horizon. Scheme revenue may be positive or negative in each year, but cumulative scheme revenue (as defined from the start of the horizon) may not fall below some lower limit. 


\subsection{Price smoothing - revenue neutrality for transitional period}
A carbon price of 40 \$/MWh is imposed. Revenue up until the transitional year may be positive or negative. From the transitional year onwards net scheme revenue = 0 in all years for the remainder of the model horizon.

\section{Solution algorithm}

\begin{figure}
	\centering
	\includegraphics{./price_setting_algorithm.pdf}
	\caption{Solution algorithm}
\end{figure}

\end{document}