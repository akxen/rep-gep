\documentclass{article}

\setlength{\parindent}{0pt}
\setlength{\parskip}{8pt}



%\usepackage{../notation/notation}
\usepackage{notation}
\usepackage{geometry,amsmath,amssymb,bm,mathtools,graphicx,pdfpages,tikz,float,blkarray,longtable,titlesec,cases,bm,titlesec}
\graphicspath{{./figures/}}
\setcounter{secnumdepth}{4}

\titleformat{\paragraph}
{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

\geometry{
	a4paper,
	total={170mm,257mm},
	left=15mm,
	top=30mm,
	right=15mm,
	bottom=30mm
}

\title{Refunded Emissions Payment Scheme: Long-run Parameter Calibration\\MINLP GEP formulation}
%\widehat{}\textasciicaron

% Sets
\newcommand{\sGenerators}{G}
\newcommand{\sGeneratorsExisting}{G^{\mathrm{E}}}
\newcommand{\sGeneratorsExistingThermal}{G^{\mathrm{E,T}}}
\newcommand{\sGeneratorsExistingWind}{G^{\mathrm{E,W}}}
\newcommand{\sGeneratorsExistingSolar}{G^{\mathrm{E,S}}}
\newcommand{\sGeneratorsCandidate}{G^{\mathrm{C}}}
\newcommand{\sGeneratorsCandidateThermal}{G^{\mathrm{C,T}}}
\newcommand{\sGeneratorsCandidateWind}{G^{\mathrm{C,W}}}
\newcommand{\sGeneratorsCandidateSolar}{G^{\mathrm{C,S}}}
\newcommand{\sGeneratorsThermal}{G^{\mathrm{T}}}
\newcommand{\sGeneratorsHydro}{G^{\mathrm{H}}}
\newcommand{\sStorage}{G^{\mathrm{Q}}}
\newcommand{\sStorageExisting}{G^{\mathrm{E,Q}}}
\newcommand{\sStorageCandidate}{G^{\mathrm{C,Q}}}
\newcommand{\sYears}{Y}
\newcommand{\sScenarios}{S}
\newcommand{\sIntervals}{T}
\newcommand{\sZones}{Z}
\newcommand{\sRegions}{R}
\newcommand{\sInvestmentSizeOptions}{N^{\mathrm{C}}}
\newcommand{\sInvestmentSizeOptionsGenerator}[1][\iGenerator]{\sInvestmentSizeOptions_{#1}}
\newcommand{\sGeneratorsExistingThermalQuickStart}{G^{\mathrm{E,T}}_\mathrm{Q}}
\newcommand{\sGeneratorsCandidateThermalQuickStart}{G^{\mathrm{C,T}}_\mathrm{Q}}
\newcommand{\sGeneratorsThermalQuickStart}{G^{\mathrm{T}}_\mathrm{Q}}
\newcommand{\sGeneratorsExistingThermalSlowStart}{G^{\mathrm{E,T}}_\mathrm{S}}
\newcommand{\sLinks}{L}
\newcommand{\sScenariosYear}{\sScenarios_{\iYear}}

% Indices
\newcommand{\iGenerator}{g}
\newcommand{\iYear}{y}
\newcommand{\iYearTerminal}{\overline{\iYear}}
\newcommand{\iYearAlias}{j}
\newcommand{\iScenario}{s}
\newcommand{\iScenarioAlias}{m}
\newcommand{\iInterval}{t}
\newcommand{\iIntervalAlias}{k}
\newcommand{\iIntervalTerminal}{\overline{\iInterval}}

\newcommand{\iZone}{z}
\newcommand{\iRegion}{r}
\newcommand{\iInvestmentSizeOption}{n}
\newcommand{\iLink}{l}

% Parameters
\newcommand{\cOperatingCost}[1][\iYear,\iScenario]{\mathrm{OP}_{#1}}
\newcommand{\cOperatingCostThermal}[1][\iYear,\iScenario]{\mathrm{OP}^{\mathrm{T}}_{#1}}
\newcommand{\cOperatingCostHydro}[1][\iYear,\iScenario]{\mathrm{OP}^{\mathrm{H}}_{#1}}
\newcommand{\cOperatingCostWind}[1][\iYear,\iScenario]{\mathrm{OP}^{\mathrm{W}}_{#1}}
\newcommand{\cOperatingCostSolar}[1][\iYear,\iScenario]{\mathrm{OP}^{\mathrm{S}}_{#1}}
\newcommand{\cOperatingCostStorage}[1][\iYear,\iScenario]{\mathrm{OP}^{\mathrm{Q}}_{#1}}
\newcommand{\cFixedOperationsMaintenanceCost}[1][\iYear]{\mathrm{FOM}_{#1}}
\newcommand{\cFixedOperationsMaintenanceCostGenerator}[1][\iGenerator]{C^{\mathrm{FOM}}_{#1}}
\newcommand{\cScenarioDuration}[1][\iYear,\iScenario]{\rho_{#1}}
\newcommand{\cMarginalCost}[1][\iGenerator,\iYear]{C^{\mathrm{MC}}_{#1}}
\newcommand{\cStartupCost}[1][\iGenerator]{C^{\mathrm{SU}}_{#1}}
\newcommand{\cShutdownCost}[1][\iGenerator]{C^{\mathrm{SD}}_{#1}}
\newcommand{\cEmissionsIntensity}[1][\iGenerator]{E_{#1}}
\newcommand{\cPowerOutputMax}[1][\iGenerator,\iYear]{\overline{P}_{#1}}
\newcommand{\cAmortisationRate}[1][\iGenerator]{\gamma_{#1}}
\newcommand{\cCandidateInvestmentCost}[1][\iGenerator,\iYear]{I^{\mathrm{C}}_{#1}}
\newcommand{\cInvestmentCost}[1][\iYear]{\mathrm{INV}_{#1}}
\newcommand{\cInterestRate}{i}
\newcommand{\cAssetLifetime}[1][\iGenerator]{A_{#1}}
\newcommand{\cTotalPresentValue}[1][]{\mathrm{TPV}_{#1}}
\newcommand{\cInvestmentSize}{X^{\mathrm{C,T}}_{\iGenerator,\iInvestmentSizeOption}}
\newcommand{\cBuildLimitWind}{B^{\mathrm{C,\mathrm{W}}}_{\iZone}}
\newcommand{\cBuildLimitSolar}{B^{\mathrm{C,\mathrm{S}}}_{\iZone}}
\newcommand{\cBuildLimitStorage}{B^{\mathrm{C,\mathrm{Q}}}_{\iZone}}
\newcommand{\cReserveUpRequirement}[1][\iRegion]{D^{+}_{#1}}
\newcommand{\cUpTimeMin}[1][\iGenerator]{TU_{#1}}
\newcommand{\cDownTimeMin}[1][\iGenerator]{TD_{#1}}
\newcommand{\cRampRateUp}[1][\iGenerator]{RU_{#1}}
\newcommand{\cRampRateDown}[1][\iGenerator]{RD_{#1}}
\newcommand{\cPowerOutputMin}[1][\iGenerator]{\underline{P}_{#1}}
\newcommand{\cStartupDuration}[1][\iGenerator]{SU_{#1}^{\mathrm{D}}}
\newcommand{\cStartupTrajectory}[1][\iGenerator,\iIntervalAlias]{P^{\mathrm{SU}}_{#1}}
\newcommand{\cShutdownDuration}[1][\iGenerator]{SD_{#1}^{\mathrm{D}}}
\newcommand{\cShutdownTrajectory}[1][\iGenerator,\iIntervalAlias]{P^{\mathrm{SD}}_{#1}}
\newcommand{\cCapacityFactorWind}[1][\iGenerator,\iYear,\iScenario,\iInterval]{Q_{#1}^{\mathrm{W}}}
\newcommand{\cCapacityFactorSolar}[1][\iGenerator,\iYear,\iScenario,\iInterval]{Q_{#1}^{\mathrm{S}}}
\newcommand{\cPowerChargingMax}[1][\iGenerator]{\overline{P}^{\mathrm{in}}_{#1}}
\newcommand{\cPowerDischargingMax}[1][\iGenerator]{\overline{P}^{\mathrm{out}}_{#1}}
\newcommand{\cStorageUnitEnergyMax}[1][\iGenerator]{\overline{Q}_{#1}}
\newcommand{\cStorageUnitEnergyIntervalEndMax}[1][\iGenerator]{\overline{Q}^{\mathrm{end}}_{#1}}
\newcommand{\cStorageUnitEnergyIntervalEndMin}[1][\iGenerator]{\underline{Q}^{\mathrm{end}}_{#1}}
\newcommand{\cStorageUnitEfficiencyCharging}{\eta_{\iGenerator}^{\mathrm{in}}}
\newcommand{\cStorageUnitEfficiencyDischarging}{\eta_{\iGenerator}^{\mathrm{out}}}
\newcommand{\cDemand}[1][\iZone,\iYear,\iScenario,\iInterval]{D_{#1}}
\newcommand{\cIncidenceMatrix}[1][\iZone,\iLink]{K_{#1}}
\newcommand{\cOperatingCostLostLoad}[1][\iYear,\iScenario]{\mathrm{OP}^{\mathrm{L}}_{#1}}
\newcommand{\cPowerFlowMin}{\underline{P}_{\iLink}^{L}}
\newcommand{\cPowerFlowMax}{\overline{P}_{\iLink}^{L}}
\newcommand{\cEmmissionsCumulativeTarget}{\overline{E}}
\newcommand{\cSchemeRevenueCumulativeTarget}{\overline{R}}
\newcommand{\cLostLoadCost}{C^{\mathrm{L}}}
\newcommand{\cReserveUpViolationPenalty}{C^{\mathrm{R}}}
\newcommand{\cOperatingCostReserveUpViolation}[1][\iYear,\iScenario]{\mathrm{OP}^{\mathrm{R}}_{#1}}
\newcommand{\cPowerOutputMinProportion}{\cPowerOutputMin^{\mathrm{f}}}
\newcommand{\cEmissionsTargetViolationPenalty}{C^{\mathrm{E}}}
\newcommand{\cEmissionsViolationTotalCost}{\mathrm{PEN}}
\newcommand{\cObjectiveFunction}{\mathrm{COST}}
\newcommand{\cOperatingCostScenario}[1][\iYear,\iScenario]{\mathrm{SCEN}_{#1}}
\newcommand{\cRetirementIndicator}[1][\iGenerator,\iYear]{F_{#1}}
\newcommand{\cEmissionsTotal}{E^{\mathrm{TOT}}}
\newcommand{\cRampRateStartup}[1][\iGenerator]{SU_{#1}}
\newcommand{\cRampRateShutdown}[1][\iGenerator]{SD_{#1}}
\newcommand{\cPowerOutputHydro}[1][\iGenerator,\iYear,\iScenario,\iInterval]{P^{\mathrm{H}}_{#1}}
\newcommand{\cDiscountRate}[1][\iYear]{\delta_{#1}}

% Variables
\newcommand{\vBaseline}[1][\iYear]{\phi_{#1}}
\newcommand{\vPermitPrice}[1][\iYear]{\tau_{#1}}
\newcommand{\vEnergy}[1][\iGenerator,\iYear,\iScenario,\iInterval]{e_{#1}}
\newcommand{\vStartupIndicator}[1][\iGenerator,\iYear,\iScenario,\iInterval]{v_{#1}}
\newcommand{\vShutdownIndicator}[1][\iGenerator,\iYear,\iScenario,\iInterval]{w_{#1}}
\newcommand{\vInstalledCapacity}[1][\iGenerator,\iYear]{x^{\mathrm{C}}_{#1}}
\newcommand{\vInvestmentSizeIndicator}[1][\iGenerator,\iYear,\iInvestmentSizeOption]{d_{#1}}
\newcommand{\vReserveUp}[1][\iGenerator,\iYear,\iScenario,\iInterval]{r^{+}_{#1}}
\newcommand{\vReserveUpViolation}[1][\iRegion,\iYear,\iScenario,\iInterval]{r^{\mathrm{V}}_{#1}}
\newcommand{\vOnIndicator}[1][\iGenerator,\iYear,\iScenario,\iInterval]{u_{#1}}
\newcommand{\vPower}[1][\iGenerator,\iYear,\iScenario,\iInterval]{p_{#1}}
\newcommand{\vPowerTotal}[1][\iGenerator,\iYear,\iScenario,\iInterval]{\hat{p}_{#1}}
\newcommand{\vPowerTotalIn}[1][\iGenerator,\iYear,\iScenario,\iInterval]{\hat{p}^{\mathrm{in}}_{#1}}
\newcommand{\vPowerTotalOut}[1][\iGenerator,\iYear,\iScenario,\iInterval]{\hat{p}^{\mathrm{out}}_{#1}}
%\newcommand{\vEnergy}[1][\iGenerator,\iYear,\iScenario,\iInterval]{e_{#1}}
\newcommand{\vStorageUnitEnergy}[1][\iGenerator,\iYear,\iScenario,\iInterval]{q_{#1}}
\newcommand{\vPowerFlow}[1][\iLink,\iYear,\iScenario,\iInterval]{p^{\sLinks}_{#1}}
\newcommand{\vLostLoadEnergy}[1][\iZone,\iYear,\iScenario,\iInterval]{e^{\mathrm{V}}_{#1}}
\newcommand{\vLostLoadPower}[1][\iZone,\iYear,\iScenario,\iInterval]{p^{\mathrm{V}}_{#1}}
\newcommand{\vEmissionsTargetViolation}{f^{\mathrm{E}}}
\newcommand{\vInstalledCapacityTotal}[1][\iGenerator,\iYear]{a_{#1}}
\newcommand{\vInstalledCapacityTotalScenario}[1][\iGenerator,\iYear,\iScenario]{b_{#1}}
\newcommand{\vInstalledCapacityOnStateAux}[1][\iGenerator,\iYear,\iScenario,\iInterval]{x_{#1}}
\newcommand{\vInstalledCapacityStartupStateAux}[1][\iGenerator,\iYear,\iScenario,\iInterval]{y_{#1}}
\newcommand{\vInstalledCapacityShutdownStateAux}[1][\iGenerator,\iYear,\iScenario,\iInterval]{z_{#1}}
\newcommand{\vFixedCapacityDual}[1][\iGenerator,\iYear,\iScenario]{\psi_{#1}}

% Operators
\DeclareMathOperator*{\minimise}{minimise}

\begin{document}
	\maketitle
	

\section{Notation}
\renewcommand*{\arraystretch}{1.3}
\begin{longtable}{ p{.09\textwidth}  p{.75\textwidth}}
	\textbf{Symbol} & \textbf{Description}\\
	\hline\hline
	\multicolumn{2}{l}{\textbf{Indices}}\\
	$\iGenerator$ & Generator\\ 
	$\iYear$ & Year\\
	$\iYearAlias$ & Year alias\\
	$\iYearTerminal$ & Final year in model horizon\\
	$\iScenario$ & Scenario\\
	$\iScenarioAlias$ & Scenario alias\\
	$\iInterval$ & Interval\\
	$\iIntervalAlias$ & Interval alias\\
	$\iIntervalTerminal$ & Final interval\\
	$\iZone$ & NEM zone\\
	$\iRegion$ & NEM region\\
	$\iInvestmentSizeOption$ & Investment size option\\
	$\iLink$ & Link connecting adjacent NEM zones\\
	& \\
	\multicolumn{2}{l}{\textbf{Sets}}\\
	$\sGenerators$ & All generators\\
	$\sGeneratorsExisting$ & Existing generators\\
	$\sGeneratorsExistingThermal$ & Existing thermal generators\\
	$\sGeneratorsExistingWind$ & Existing wind units\\
	$\sGeneratorsExistingSolar$ & Existing solar units\\
	$\sGeneratorsCandidate$ & Candidate generators\\
	$\sGeneratorsCandidateThermal$ & Candidate thermal generators\\
	$\sGeneratorsCandidateWind$ & Candidate wind units\\
	$\sGeneratorsCandidateSolar$ & Candidate solar units\\
	$\sGeneratorsThermal$ & All thermal generators\\
	$\sGeneratorsHydro$ & Hydro generators\\
	$\sStorage$ & All storage units\\
	$\sStorageExisting$ & Existing storage units\\
	$\sStorageCandidate$ & Candidate storage units\\
	$\sYears$ & Years in model horizon\\
	$\sScenarios$ & Operating scenarios\\
	$\sIntervals$ & Time intervals\\
	$\sZones$ & NEM zones\\
	$\sRegions$ & NEM regions\\
	$\sInvestmentSizeOptions$ & Investment size options\\
	$\sInvestmentSizeOptionsGenerator$ & Investment size options for generator $\iGenerator$\\
	$\sGeneratorsExistingThermalQuickStart$ & Existing quick-start thermal generators\\
	$\sGeneratorsCandidateThermalQuickStart$ & Candidate quick-start thermal generators\\
	$\sGeneratorsThermalQuickStart$ & All quick-start thermal generators\\
	$\sGeneratorsExistingThermalSlowStart$ & Existing slow-start generators\\
	$\sLinks$ & Links connecting NEM zones\\
	$\sScenariosYear$ & Operating scenarios constituting with year $\iYear$\\
	& \\
	\multicolumn{2}{l}{\textbf{Variables}}\\
	$\vBaseline$ & Emissions intensity baseline [tCO$_{2}$/MWh]\\
	$\vPermitPrice$ & Permit price [\$/tCO$_{2}$]\\

	$\vOnIndicator$ & On indicator [--]\\
	$\vStartupIndicator$ & Startup indicator [--]\\
	$\vShutdownIndicator$ & Shutdown indicator [--]\\

	$\vPower$ & Power output above minimum dispatchable level [MW]\\
	$\vPowerTotal$ & Total power output [MW]\\
	$\vPowerTotalIn$ & Total charging power (storage unit) [MW]\\
	$\vPowerTotalOut$ & Total discharging power (storage unit) [MW]\\

	$\vReserveUp$ & Reserve provision [MW]\\
	$\vReserveUpViolation$ & Up-reserve constraint violation [MW]\\
	
	$\vEnergy$ & Energy output [MWh]\\
	$\vStorageUnitEnergy$ & Energy within storage unit [MWh]\\

	$\vLostLoadPower$ & Lost load power [MW]\\
	$\vLostLoadEnergy$ & Lost load energy [MWh]\\
	$\vPowerFlow$ & Powerflow over link connecting adjacent NEM zones [MW]\\
	$\vEmissionsTargetViolation$ & Emissions target violation [tCO$_{2}$]\\
	$\vInstalledCapacity$ & Capacity installed in year $\iYear$ [MW]\\
	$\vInvestmentSizeIndicator$ & Investment size indicator [--]\\
	$\vInstalledCapacityTotal$ & Total capacity available in year $\iYear$ [MW]\\
	$\vInstalledCapacityTotalScenario$ & Total installed capacity for scenario $\iScenario$ [MW]\\
	$\vInstalledCapacityOnStateAux$ & Auxiliary variable - installed capacity and on-state interaction [--]\\
	$\vInstalledCapacityStartupStateAux$ & Auxiliary variable - installed capacity and startup-state interaction [--]\\
	$\vInstalledCapacityShutdownStateAux$ & Auxiliary variable - installed capacity and shutdown-state interaction [--]\\
	& \\
	\multicolumn{2}{l}{\textbf{Parameters}}\\
	$\cObjectiveFunction$ & Total cost over model horizon [\$]\\
	$\cTotalPresentValue$ & Total present value of operating, investment, and FOM costs [\$]\\
	$\cInvestmentCost$ & Total investment cost [\$]\\
	$\cFixedOperationsMaintenanceCost$ & Total fixed operations and maintenance cost for year $\iYear$ [\$]\\
	$\cEmissionsViolationTotalCost$ & Cost of violating emissions target [\$]\\
	$\cOperatingCostScenario$ & Total cost for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCost$ & Total operating cost for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostThermal$ & Cost to operate thermal units for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostHydro$ & Cost to operate hydro units for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostWind$ & Cost to operate wind units for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostSolar$ & Cost to operate solar units for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostStorage$ & Cost to operate storage units for scenario $\iScenario$ in year $\iYear$ [\$]\\
	$\cOperatingCostReserveUpViolation$ & Cost of reserve violation [\$]\\
	$\cOperatingCostLostLoad$ & Lost load cost [\$]\\
	$\cCandidateInvestmentCost$ & Candidate unit investment cost [\$/MW]\\
	$\cLostLoadCost$ & Lost load penalty [\$/MWh]\\
	$\cReserveUpViolationPenalty$ & Minimum upward reserve violation [MW]\\
	$\cFixedOperationsMaintenanceCostGenerator$ & Fixed operations and maintenance cost for generator $\iGenerator$ [\$]\\
	$\cEmissionsTargetViolationPenalty$ & Emissions target violation penalty [\$/tCO$_{2}$]\\
	$\cMarginalCost$ & Short-run marginal cost [\$/MWh]\\
	$\cStartupCost$ & Normalised startup-cost [\$/MW]\\
	$\cShutdownCost$ & Normalised shutdown-cost [\$/MW]\\
	$\cAmortisationRate$ & Amorisation rate [--]\\
	$\cInterestRate$ & Interest rate (weighted average cost of capital) [--]\\
	$\cAssetLifetime$ & Asset lifetime [years]\\
	$\cInvestmentSize$ & Investment size option [MW]\\
	$\cScenarioDuration$ & Scenario duration [h]\\
	$\cRetirementIndicator$ & Retirement indicator [--]\\
	$\cEmissionsIntensity$ & Emissions intensity for generator $\iGenerator$\\
	$\cPowerOutputMax$ & Maximum power output [MW]\\
	$\cPowerOutputMin$ & Minimum power output [MW]\\
	$\cPowerOutputMinProportion$ & Minimum dispatchable output level as a proportion of total capacity [--]\\
	$\cPowerOutputHydro$ & Hydro power output [MW]\\
	$\cUpTimeMin$ & Minimum up time [hours]\\
	$\cDownTimeMin$ & Minimum down time [hours]\\
	$\cStartupDuration$ & Hours required to reach minimum dispatchable output following startup [hours]\\
	$\cShutdownDuration$ & Hours required to transition from minimum dispatchable output to zero MW [hours]\\
	$\cStartupTrajectory$ & Power output along startup trajectory [MW]\\
	$\cShutdownTrajectory$ & Power output along shutdown trajectory [MW]\\
	$\cRampRateUp$ & Ramp rate up (normal operation) [MW/h]\\
	$\cRampRateDown$ & Ramp down up (normal operation) [MW/h]\\
	$\cRampRateStartup$ & Ramp rate (startup) [MW/h]\\
	$\cRampRateShutdown$ & Ramp rate (shutdown) [MW/h]\\
	$\cPowerChargingMax$ & Storage unit maximum charging power [MW]\\
	$\cPowerDischargingMax$ & Storage unit maximum discharging power [MW]\\
	$\cStorageUnitEnergyMax$ & Storage unit maximum energy capacity [MWh]\\
	$\cStorageUnitEnergyIntervalEndMax$ & Storage unit maximum energy at end of operating scenario [MWh]\\
	$\cStorageUnitEnergyIntervalEndMin$ & Storage unit minimum energy at end of operating scenario [MWh]\\
	$\cStorageUnitEfficiencyCharging$ & Storage unit charging efficiency [--]\\
	$\cStorageUnitEfficiencyDischarging$ & Storage unit discharging efficiency [--]\\
	$\cDemand$ & Demand [MW]\\
	$\cReserveUpRequirement$ & Minimum up reserve requirement [MW]\\
	$\cCapacityFactorWind$ & Capacity factor for wind units [--]\\
	$\cCapacityFactorSolar$ & Capacity factor for solar units [--]\\
	$\cBuildLimitWind$ & Build limit for wind units in zone $\iZone$ [MW]\\
	$\cBuildLimitSolar$ & Build limit for wind units in zone $\iZone$ [MW]\\
	$\cBuildLimitStorage$ & Build limit for storage units in zone $\iZone$ [MW]\\
	$\cIncidenceMatrix$ & Network incidence matrix [--]\\
	$\cPowerFlowMin$ & Minimum powerflow over link $\iLink$ [MW]\\
	$\cPowerFlowMax$ & Maximum powerflow over link $\iLink$ [MW]\\
	$\cEmissionsTotal$ & Total emissions [tCO$_{2}$]\\
	$\cEmmissionsCumulativeTarget$ & Cumulative emissions target [tCO$_{2}$]\\
	$\cSchemeRevenueCumulativeTarget$ & Cumulative scheme revenue target [\$]\\
	\hline
	\caption{Notation}
\end{longtable}

\section{Data}
Capacity expansion models require input assumptions related to current and expected build costs for different types of technologies, fuel costs, and expected capacity factors for renewable plant. Input assumptions used in AEMO's long-run capacity expansion models are used to construct representative operating scenarios for each year in the model horizon. For each year, a total of ten operating scenarios are constructed, each 24 hours in duration. Nine of these scenarios are constructed via the application of a k-means scenario reduction algorithm. The tenth is the 24 hour interval that contains peak system demand for that year. Including the peak day is important as it can help determine if there is sufficient capacity within the system to meet peak demand, and penalise any load that is lost. The following plots visualise build costs, fuel costs, and capacity factors for selection wind bubbles / NEM zones.


\begin{figure}
	\includegraphics{build_costs_coal.pdf}
	\caption{Build costs - candidate coal units}
\end{figure}

\begin{figure}
	\includegraphics{build_costs_gas.pdf}
	\caption{Build costs - candidate gas units}
\end{figure}

\begin{figure}
	\includegraphics{build_costs_wind.pdf}
	\caption{Build costs - candidate wind units}
\end{figure}

\begin{figure}
	\includegraphics{build_costs_solar.pdf}
	\caption{Build costs - candidate solar units}
\end{figure}

\begin{figure}
	\includegraphics{fuel_cost_coal.pdf}
	\caption{Fuel cost profiles - coal units}
\end{figure}

\begin{figure}
	\includegraphics{fuel_cost_gas.pdf}
	\caption{Fuel cost profiles - gas units}
\end{figure}

\begin{figure}
	\includegraphics{demand_profiles_ADE.pdf}
	\caption{ADE demand profiles - 2020}
\end{figure}

\begin{figure}
	\includegraphics{solar_profiles_ADE-DAT.pdf}
	\caption{ADE dual axis tracking solar generator capacity factors - 2020}
\end{figure}

\begin{figure}
	\includegraphics{wind_profiles_YPS.pdf}
	\caption{YPS capacity factors - 2020}
\end{figure}


\section{Model}
The goal is to model operational investment decisions for Australia, with a model horizon from 2016-50. Furthermore, a unit commitment model is to be embedded within a generation expansion planning model to better represent operating scenarios under scenarios where renewables and storage are likely to play an increasing role within the grid. These considerations are in-line with recent work that has suggested unit commitment constraints are important in when considering generation expansion planning issues. As the proportion of intermittent renewables within a power system increases, it's likely that the ramping capabilities and constraints of incumbent generators are likely to play a greater role in accommodating the influx of renewables (either ramping up or down to account for fluctuations in output from wind or solar units). 

A key challenge with embedding a unit commitment model within a generation expansion planning framework is the computational complexity such an arrangement elicits. While solving the model for one scenario is fine (taking on average 20s), considering multiple scenarios simultaneously is extremely challenging; the model cannot even be loaded into memory when considering a large number of scenarios, let alone be solved within a reasonable duration. Consequently, a decomposition strategy is required in order to solve this problem. The approach adopted makes use of Optimality Condition Decomposition, which is essentially a particular implementation of a Lagrangian Relaxation procedure. While the OCD method has been used to solve the powerflow problems REF, to my knowledge this is the first time it has been used used within a generation expansion planning type framework.

\subsection{Costs}
\subsubsection{Operating costs for a representative day}
Thermal generators:
\begin{align}
\begin{split}
\cOperatingCostThermal = \sum\limits_{\iInterval} & \left[\sum\limits_{\iGenerator \in \sGeneratorsThermal} (\cMarginalCost + (\cEmissionsIntensity - \vBaseline)\vPermitPrice)\vEnergy + \sum\limits_{\iGenerator \in \sGeneratorsExistingThermal} \left[\cStartupCost \cPowerOutputMax \vStartupIndicator + \cShutdownCost \cPowerOutputMax \vShutdownIndicator\right] \right.\\
& \left. + \sum\limits_{\iGenerator \in \sGeneratorsCandidateThermal} \left[\cStartupCost \vInstalledCapacityTotalScenario \vStartupIndicator + \cShutdownCost \vInstalledCapacityTotalScenario \vShutdownIndicator\right] \right]\\
\end{split}
\label{eqn: total thermal generator operating cost}
\end{align}

Hydro generators:
\begin{equation}
\cOperatingCostHydro = \sum\limits_{\iInterval}\sum\limits_{\iGenerator \in \sGeneratorsHydro}\cMarginalCost[\iGenerator] \vEnergy
\end{equation}

Wind generators:
\begin{equation}
\cOperatingCostWind = \sum\limits_{\iInterval}\left[\sum\limits_{\iGenerator \in \sGeneratorsExistingWind} \cMarginalCost[\iGenerator] \vEnergy + \sum\limits_{\iGenerator \in \sGeneratorsCandidateWind} \left[\cMarginalCost[\iGenerator] - \vBaseline \vPermitPrice\right] \vEnergy\right]
\end{equation}

Solar generators:
\begin{equation}
\cOperatingCostSolar = \sum\limits_{\iInterval}\left[\sum\limits_{\iGenerator \in \sGeneratorsExistingSolar} \cMarginalCost[\iGenerator] \vEnergy + \sum\limits_{\iGenerator \in \sGeneratorsCandidateSolar} \left[\cMarginalCost[\iGenerator] - \vBaseline\vPermitPrice\right] \vEnergy\right]
\end{equation}

Storage units:
\begin{equation}
\cOperatingCostStorage = \sum\limits_{\iInterval}\sum\limits_{\iGenerator \in \sStorage} \cMarginalCost[\iGenerator] \vEnergy
\end{equation}

Value of lost load:
\begin{equation}
\cOperatingCostLostLoad = \sum\limits_{\iInterval}\sum\limits_{\iZone \in \sZones} \cLostLoadCost \vLostLoadEnergy
\end{equation}

Penalty for violating reserve requirements:
\begin{equation}
\cOperatingCostReserveUpViolation = \sum\limits_{\iInterval}\sum\limits_{\iRegion \in \sRegions} \cReserveUpViolationPenalty \vReserveUpViolation
\end{equation}

Total operating cost for a given scenario, $\iScenario$:
\begin{equation}
\cOperatingCostScenario = \cOperatingCostThermal + \cOperatingCostHydro + \cOperatingCostWind + \cOperatingCostSolar + \cOperatingCostStorage + \cOperatingCostLostLoad + \cOperatingCostReserveUpViolation
\end{equation}

Total operating cost for a given year, $\iYear$.

\begin{equation}
\cOperatingCost[\iYear] = \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \cOperatingCostScenario
\end{equation}

Note that each scenario, $\iScenario$, is scaled by $\cScenarioDuration$ which represents the number of days the scenario occurs in year $\iYear$:

\subsubsection{Fixed operation and maintenance (FOM) costs}

\begin{equation}
\cFixedOperationsMaintenanceCost = \left[\sum\limits_{\iGenerator \in \sGeneratorsCandidate} \cFixedOperationsMaintenanceCostGenerator \vInstalledCapacityTotal + \sum\limits_{\iGenerator \in \sGeneratorsExisting} \cFixedOperationsMaintenanceCostGenerator \cPowerOutputMax[\iGenerator] \left(1 - \cRetirementIndicator\right) \right]
\end{equation}

\subsection{Investment cost}

\begin{equation}
\cInvestmentCost = \sum\limits_{g\in \sGeneratorsCandidate} \cAmortisationRate  \cCandidateInvestmentCost \vInstalledCapacity
\end{equation}

Where $\cAmortisationRate$ is the amortisation rate for the investment:

\begin{equation}
\cAmortisationRate = \frac{\cInterestRate(1+\cInterestRate)^{\cAssetLifetime}}{(1+\cInterestRate)^{\cAssetLifetime} - 1}
\end{equation}

\subsubsection{Constraint violation penalties}
Cumulative emissions constraint violation penalty:
\begin{equation}
\cEmissionsViolationTotalCost = \cEmissionsTargetViolationPenalty \vEmissionsTargetViolation
\end{equation}

\subsubsection{Total present value}
In order to take into account the time value of money a discount rate should be applied to terms within the objective. This allows operational cost values to be expressed in terms or a common base. Let the discount rate be denoted by:

\begin{equation}
	\cDiscountRate = \frac{1}{(1 + \cInterestRate)^{\iYear}}
\end{equation}

Total present value over planning horizon:
\begin{align}
\begin{split}
\cTotalPresentValue & = \sum\limits_{\iYear \in \sYears} \frac{\cDiscountRate}{\cInterestRate}\cInvestmentCost + \sum\limits_{\iYear \in \sYears} \left[\cDiscountRate (\cOperatingCost[\iYear] + \cFixedOperationsMaintenanceCost) \right] + \frac{\cDiscountRate[\iYearTerminal]}{\cInterestRate} \left(\cOperatingCost[\iYearTerminal] + \cFixedOperationsMaintenanceCost[\iYearTerminal] \right)
\end{split}
\end{align}

Note the discounted investment cost is divided by the interest rate $\cInterestRate$ to yield the present value of the amortised investment cost which is paid in perpetuity. This assumes that once the unit reaches the end of its physical life it will be replaced by an identical unit. The second term represents the present value of the total operating costs for the entire system, while the following term captures the costs incurred beyond the end of the model horizon. It assumes that the costs incurred in the last year of the model horizon will be incurred in all future years. This enables end-of-year effects to be taken into account - preventing the model from biasing investment towards the beginning or end of the model horizon.

\subsection{Objective function}
The objective function is equal to the total present value of the investment and operational plan over the model horizon, plus a term penalising violation of the cumulative emissions constraint, which is included to ensure sub-problem feasibility.

\begin{equation}
\cObjectiveFunction = \cTotalPresentValue + \cEmissionsViolationTotalCost
\end{equation}


\subsection{Constraints}
\subsubsection{Investment constraints}

Discrete investment decisions for candidate thermal generators:

\begin{equation}
\vInstalledCapacity - \sum\limits_{\iInvestmentSizeOption \in \sInvestmentSizeOptionsGenerator} \vInvestmentSizeIndicator \cInvestmentSize = 0 \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears 
\label{eqn: candidate thermal unit capacity}
\end{equation}

\begin{equation}
\sum\limits_{\iInvestmentSizeOption \in \sInvestmentSizeOptionsGenerator} \vInvestmentSizeIndicator - 1 = 0 \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears
\label{eqn: capacity thermal unit discrete size option - single choice}
\end{equation}

Continuous capacity sizing for solar, wind, and storage units:

\begin{equation}
- \vInstalledCapacity[\iGenerator,\iYear] \leq 0 \quad \forall \iGenerator \in \sGeneratorsCandidateSolar \cup \sGeneratorsCandidateWind \cup \sStorageCandidate \quad \forall \iYear \in \sYears
\label{eqn: non negative investment capacity}
\end{equation}

Introduce auxiliary variables to denote the total capacity installed at each point in time:

\begin{equation}
	\vInstalledCapacityTotal - \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias] = 0 \quad \forall \iGenerator \in \sGeneratorsCandidate \quad \forall \iYear \in \sYears
\end{equation}

Build limits for different technologies in each zone:
\begin{equation}
\sum\limits_{\iGenerator \in \sGeneratorsCandidateSolar_{\iZone}} \vInstalledCapacityTotal - \cBuildLimitSolar \leq 0 \quad \forall \iZone \in \sZones \quad \forall \iYear \in \sYears
\end{equation}

\begin{equation}
\sum\limits_{\iGenerator \in \sGeneratorsCandidateWind_{\iZone}} \vInstalledCapacityTotal - \cBuildLimitWind \leq 0 \quad \forall \iZone \in \sZones \quad \forall \iYear \in \sYears 
\end{equation}

\begin{equation}
\sum\limits_{\iGenerator \in \sStorageCandidate_{\iZone}} \vInstalledCapacityTotal - \cBuildLimitStorage \leq 0  \quad \forall \iZone \in \sZones \quad \forall \iYear \in \sYears
\label{eqn: storage build limits}
\end{equation}

\subsection{Unit commitment constraints}
Ensures sufficient dispatchable power reserve in each region.
\begin{equation}
\sum\limits_{\iGenerator \in \sGeneratorsExistingThermal_{\iRegion} \cup \sGeneratorsCandidateThermal_{\iRegion} \cup \sStorageExisting_{\iRegion} \cup \sStorageCandidate_{\iRegion}} \vReserveUp + \vReserveUpViolation \geq \cReserveUpRequirement \quad \forall \iRegion \in \sRegions \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\label{eqn: reserve constraints}
\end{equation}

Coordinates generator state logic (on, off, start-up, shutdown):
\begin{equation}
\vOnIndicator - \vOnIndicator[\iGenerator,\iYear,\iScenario,\iInterval-1] = \vStartupIndicator - \vShutdownIndicator \quad \forall \iGenerator \in \sGeneratorsThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

Minimum up-time constraint:
\begin{equation}
\sum\limits_{\iIntervalAlias=\iInterval-\cUpTimeMin + 1}^{\iInterval} \vStartupIndicator[\iGenerator,\iYear,\iScenario,\iIntervalAlias] \leq \vOnIndicator \quad \forall \iGenerator \in \sGeneratorsThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \left[\cUpTimeMin, \iIntervalTerminal \right]
\end{equation}

Minimum down-time constraint:
\begin{equation}
\sum\limits_{\iIntervalAlias=\iInterval-\cDownTimeMin[\iGenerator]+1}^{\iInterval}\vShutdownIndicator[\iGenerator,\iYear,\iScenario,\iIntervalAlias] \leq 1 - \vOnIndicator \quad \forall \iGenerator \in \sGeneratorsThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \left[\cDownTimeMin, \iIntervalTerminal \right]
\end{equation}

Ramp-rate up constraint:
\begin{equation}
\left(\vPower + \vReserveUp\right) - \vPower[\iGenerator,\iYear,\iScenario,\iInterval-1] \leq \cRampRateUp \quad \forall \iGenerator \in \sGeneratorsThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

Ramp-rate down constraint:
\begin{equation}
- \vPower + \vPower[\iGenerator,\iYear,\iScenario,\iInterval-1] \leq \cRampRateDown \quad \forall \iGenerator \in \sGeneratorsThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

Ensure power production and reserves within minimum and maximum output limits for each generator - existing units:
\begin{align}
	\begin{split}
	\vPower + \vReserveUp \leq \left(\cPowerOutputMax[\iGenerator] - \cPowerOutputMin\right) \vOnIndicator - \left(\cPowerOutputMax[\iGenerator] -\cRampRateShutdown \right) \vShutdownIndicator[\iGenerator,\iYear,\iScenario,\iInterval+1] & + \left(\cRampRateStartup - \cPowerOutputMin\right)\vStartupIndicator[\iGenerator,\iYear,\iScenario,\iInterval+1]\\
	& \quad \forall \iGenerator \in \sGeneratorsExistingThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals\\
	\end{split}
\end{align}

Ensure power production and reserves within minimum and maximum output limits for each generator - candidate units:
\begin{align}
	\begin{split}
		\vPower + \vReserveUp \leq \left(1 - \cPowerOutputMinProportion\right) \vInstalledCapacityTotalScenario \vOnIndicator - \left(\vInstalledCapacityTotalScenario -\cRampRateShutdown \right) \vShutdownIndicator[\iGenerator,\iYear,\iScenario,\iInterval+1] & + \left(\cRampRateStartup - \cPowerOutputMinProportion\vInstalledCapacityTotalScenario \right)\vStartupIndicator[\iGenerator,\iYear,\iScenario,\iInterval+1]\\
		& \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals\\
		\label{eqn: power output within limits - candidate}
	\end{split}
\end{align}

Total power output - existing quick-start units:
\begin{equation}
\vPowerTotal = \cPowerOutputMin \left(\vOnIndicator + \vStartupIndicator[\iGenerator,\iYear,\iScenario,\iInterval+1]\right) + \vPower \quad \forall \iGenerator \in \sGeneratorsExistingThermalQuickStart \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

Total power output - candidate quick-start units:
\begin{equation}
\vPowerTotal = \cPowerOutputMinProportion \vInstalledCapacityTotalScenario \left(\vOnIndicator + \vStartupIndicator[\iGenerator,\iYear,\iScenario,\iInterval+1]\right) + \vPower \quad \forall \iGenerator \in \sGeneratorsCandidateThermalQuickStart \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\label{eqn: total power - quick start}
\end{equation}

Total power output - existing slow-start units:
\begin{align}
\begin{split}
\vPowerTotal =  \cPowerOutputMin \left(\vOnIndicator + \vStartupIndicator[\iGenerator,\iYear,\iScenario,\iInterval+1]\right) + & \vPower + \sum\limits_{\iIntervalAlias=1}^{\cStartupDuration} \cStartupTrajectory \vStartupIndicator[\iGenerator,\iYear,\iScenario,\iInterval-\iIntervalAlias+\cStartupDuration+2] + \sum\limits_{\iIntervalAlias=2}^{\cShutdownDuration + 1} \cShutdownTrajectory \vShutdownIndicator[\iGenerator,\iYear,\iScenario,\iInterval-\iIntervalAlias+2]\\
& \quad \forall \iGenerator \in \sGeneratorsExistingThermalSlowStart \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{split}
\end{align}

Note: There is an edge case where $\cRampRateStartup$ could be greater than $\cPowerOutputMax$ or $\vInstalledCapacityTotalScenario$, in which case $\vPowerTotal$ could be greater than the total installed capacity of the unit when it comes online. To prevent this from occurring the following constraints are added (these are not part of the original formulation given in~REF).

Ensure total power output + reserve requirement is less than installed capacity - existing units:
\begin{equation}
	0 \leq \vPowerTotal + \vReserveUp \leq \cPowerOutputMax[\iGenerator] \quad \forall \iGenerator \in \sGeneratorsExistingThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

Ensure total power output + reserve requirement is less than installed capacity - candidate units:
\begin{equation}
	0 \leq \vPowerTotal + \vReserveUp \leq \vInstalledCapacityTotalScenario \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

Total power output - wind units:
\begin{equation}
0 \leq \vPowerTotal \leq \cCapacityFactorWind \cPowerOutputMax[\iGenerator] \quad \forall \iGenerator \in \sGeneratorsExistingWind \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals 
\end{equation}

\begin{equation}
0 \leq \vPowerTotal \leq \cCapacityFactorWind \vInstalledCapacityTotalScenario \quad \forall \iGenerator \in \sGeneratorsCandidateWind \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

Total power output - solar units:

\begin{equation}
0 \leq \vPowerTotal \leq \cCapacityFactorSolar \cPowerOutputMax[\iGenerator] \quad \forall \iGenerator \in \sGeneratorsExistingSolar \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals 
\end{equation}

\begin{equation}
0 \leq \vPowerTotal \leq \cCapacityFactorSolar \vInstalledCapacityTotalScenario \quad \forall \iGenerator \in \sGeneratorsCandidateSolar \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

Total power output - hydro units (may need to adjust notation for max hydro output):

\begin{equation}
0 \leq \vPowerTotal \leq \cPowerOutputHydro \quad \forall \iGenerator \in \sGeneratorsHydro \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals 
\end{equation}

Total power output - thermal units:

\begin{equation}
0 \leq \vPowerTotal \leq \cPowerOutputMax \left(1 - \cRetirementIndicator \right) \quad \forall \iGenerator \in \sGeneratorsExistingThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

\begin{equation}
0 \leq \vPowerTotal \leq \vInstalledCapacityTotalScenario \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

Storage units:

\begin{equation}
0 \leq \vPowerTotalIn \leq \cPowerChargingMax \quad \forall \iGenerator \in \sStorageExisting \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

\begin{equation}
0 \leq \vPowerTotalIn \leq \vInstalledCapacityTotalScenario \quad \forall \iGenerator \in \sStorageCandidate \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

\begin{equation}
0 \leq \vPowerTotalOut + \vReserveUp \leq \cPowerDischargingMax \quad \forall \iGenerator \in \sStorageExisting \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

\begin{equation}
0 \leq \vPowerTotalOut + \vReserveUp \leq \vInstalledCapacityTotalScenario \quad \forall \iGenerator \in \sStorageCandidate \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

\begin{equation}
0 \leq \vStorageUnitEnergy \leq \cStorageUnitEnergyMax \quad \forall \iGenerator \in \sStorageExisting \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

\begin{equation}
0 \leq \vStorageUnitEnergy \leq \vInstalledCapacityTotalScenario \quad \forall \iGenerator \in \sStorageCandidate \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

\begin{equation}
\vStorageUnitEnergy = \vStorageUnitEnergy[\iGenerator,\iYear,\iScenario,\iInterval-1] + \cStorageUnitEfficiencyCharging \vPowerTotalIn - \frac{1}{\cStorageUnitEfficiencyDischarging} \vPowerTotalOut \quad \forall \iGenerator \in \sStorage \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}


\begin{equation}
\cStorageUnitEnergyIntervalEndMin \leq \vStorageUnitEnergy[\iGenerator,\iYear,\iScenario,\iIntervalTerminal] \leq \cStorageUnitEnergyIntervalEndMax \quad \forall \iGenerator \in \sStorage \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios
\end{equation}

Power balance for each zone:

\begin{equation}
\sum\limits_{\iGenerator \in \sGenerators_{\iZone} \setminus \sStorage_{\iZone}} \vPowerTotal - \cDemand - \sum\limits_{\iLink \in \sLinks} \cIncidenceMatrix \vPowerFlow + \sum\limits_{\iGenerator \in \sStorage_{\iZone}} \left(\vPowerTotalOut - \vPowerTotalIn\right) + \vLostLoadPower = 0 \quad \forall \iZone \in \sZones \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \iInterval \in \sIntervals
\end{equation}

Non-negative lost-load:
\begin{equation}
\vLostLoadPower \geq 0 \quad \forall \iZone \in \sZones \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \iInterval \in \sIntervals
\end{equation}

Non-negative reserve:
\begin{equation}
\vReserveUp \geq 0 \quad \forall \iGenerator \in \iGenerator \in \sGeneratorsExistingThermal_{\iRegion} \cup \sGeneratorsCandidateThermal_{\iRegion} \cup \sStorageExisting_{\iRegion} \cup \sStorageCandidate_{\iRegion} \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \iInterval \in \sIntervals
\end{equation}

Non-negative reserve violation:
\begin{equation}
\vReserveUpViolation \geq 0 \quad \forall \iZone \in \sZones \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \iInterval \in \sIntervals
\end{equation}

Power flow between zones:
\begin{equation}
\cPowerFlowMin \leq \vPowerFlow \leq \cPowerFlowMax \quad \forall \iLink \in \sLinks \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\label{eqn: powerflow constraints}
\end{equation}

Energy from generator and storage units:
\begin{equation}
\vEnergy = \begin{dcases}
\frac{\vPowerTotal[\iGenerator, \iYear,\iScenario,\iInterval-1] + \vPowerTotal}{2} & \forall \iGenerator \in \sGenerators \setminus \sStorage \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals\\
\frac{\vPowerTotalOut[\iGenerator, \iYear,\iScenario,\iInterval-1] + \vPowerTotalOut}{2} & \forall \iGenerator \in \sStorage \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals\\
\end{dcases}
\end{equation}

Lost-load energy:
\begin{equation}
\vLostLoadEnergy = \frac{\vLostLoadPower[\iZone, \iYear,\iScenario,\iInterval-1] + \vLostLoadPower}{2} \quad \forall \iZone \in \sZones \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\label{eqn: lost-load energy constraint}
\end{equation}

\subsubsection{Linearisation}
Note that constraints (\ref{eqn: power output within limits - candidate}) and (\ref{eqn: total power - quick start}), as well as the term representing thermal operating costs, (\ref{eqn: total thermal generator operating cost}), contain interactions between $\vInstalledCapacityTotalScenario$, $\vOnIndicator$, and $\vStartupIndicator$. This is because minimum power output is a function of the plant's installed capacity, which is variable within this framework. As $\vOnIndicator$, $\vStartupIndicator$, and $\vShutdownIndicator$ are binary variables their interactions with $\vInstalledCapacityTotalScenario$ can be linearised as follows:

Assuming $0 \leq \vInstalledCapacityTotalScenario \leq \vInstalledCapacityTotalScenario^{\mathrm{up}}$, introduce the following auxiliary variable:

\begin{equation}
\vInstalledCapacityOnStateAux = \vInstalledCapacityTotalScenario \vOnIndicator
\end{equation}

Where the auxiliary variable $\vInstalledCapacityOnStateAux$ is subject to the following restrictions:

\begin{equation}
\vInstalledCapacityOnStateAux \leq \vInstalledCapacityTotalScenario^{\mathrm{up}} \vOnIndicator \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\label{eqn: on state aux variable block start}
\end{equation}

\begin{equation}
\vInstalledCapacityOnStateAux \leq \vInstalledCapacityTotalScenario \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

\begin{equation}
\vInstalledCapacityOnStateAux \geq \vInstalledCapacityTotalScenario - \vInstalledCapacityTotalScenario^{\mathrm{up}} \left(1 - \vOnIndicator \right) \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

\begin{equation}
\vInstalledCapacityOnStateAux \geq 0 \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\label{eqn: on state aux variable block end}
\end{equation}

Interactions between total installed capacity and the start-up indicator variable can be represented with auxiliary variables as follows:

\begin{equation}
\vInstalledCapacityStartupStateAux = \vInstalledCapacityTotalScenario \vStartupIndicator \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

Where the auxiliary variable $\vInstalledCapacityStartupStateAux$ is subject to the following restrictions:

\begin{equation}
\vInstalledCapacityStartupStateAux \leq \vInstalledCapacityTotalScenario^{\mathrm{up}} \vStartupIndicator \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\label{eqn: startup state aux variable block start}
\end{equation}

\begin{equation}
\vInstalledCapacityStartupStateAux \leq \vInstalledCapacityTotalScenario \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

\begin{equation}
\vInstalledCapacityStartupStateAux \geq \vInstalledCapacityTotalScenario - \vInstalledCapacityTotalScenario^{\mathrm{up}} \left(1 - \vStartupIndicator \right) \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

\begin{equation}
\vInstalledCapacityStartupStateAux \geq 0 \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\label{eqn: startup state aux variable block end}
\end{equation}

Similarly, interactions between total installed capacity and the shutdown indicator variable can be represented with auxiliary variables as follows:

\begin{equation}
\vInstalledCapacityShutdownStateAux = \vInstalledCapacityTotalScenario \vShutdownIndicator \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

Where the auxiliary variable $\vInstalledCapacityShutdownStateAux$ is subject to the following restrictions:

\begin{equation}
\vInstalledCapacityShutdownStateAux \leq \vInstalledCapacityTotalScenario^{\mathrm{up}} \vShutdownIndicator \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\label{eqn: shutdown state aux variable block start}
\end{equation}

\begin{equation}
\vInstalledCapacityShutdownStateAux \leq \vInstalledCapacityTotalScenario \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

\begin{equation}
\vInstalledCapacityShutdownStateAux \geq \vInstalledCapacityTotalScenario - \vInstalledCapacityTotalScenario^{\mathrm{up}} \left(1 - \vShutdownIndicator \right) \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

\begin{equation}
\vInstalledCapacityShutdownStateAux \geq 0 \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\label{eqn: shutdown state aux variable block end}
\end{equation}

Therefore (\ref{eqn: power output within limits - candidate}) can be re-written as:

\begin{align}
\begin{split}
\vPower + \vReserveUp \leq \left(1 - \cPowerOutputMinProportion\right) \vInstalledCapacityOnStateAux - \left(\vInstalledCapacityShutdownStateAux[\iGenerator,\iYear,\iScenario,\iInterval+1] -\cRampRateShutdown \vShutdownIndicator[\iGenerator,\iYear,\iScenario,\iInterval+1] \right) & + \left(\cRampRateStartup \vStartupIndicator[\iGenerator,\iYear,\iScenario,\iInterval+1] - \cPowerOutputMinProportion \vInstalledCapacityStartupStateAux[\iGenerator,\iYear,\iScenario,\iInterval+1] \right)\\
& \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals\\
\end{split}
\end{align}

And (\ref{eqn: total power - quick start}) can be re-written as:

\begin{equation}
\vPowerTotal = \cPowerOutputMinProportion \left(\vInstalledCapacityOnStateAux + \vInstalledCapacityStartupStateAux[\iGenerator,\iYear,\iScenario,\iInterval+1]\right) + \vPower \quad \forall \iGenerator \in \sGeneratorsCandidateThermalQuickStart \quad \forall \iYear \in \sYears \quad \forall \iScenario \in \sScenarios \quad \forall \iInterval \in \sIntervals
\end{equation}

And (\ref{eqn: total thermal generator operating cost}) can be re-written as:

\begin{align}
\begin{split}
\cOperatingCostThermal = \cScenarioDuration\sum\limits_{\iInterval} & \left[\sum\limits_{\iGenerator \in \sGeneratorsThermal} (\cMarginalCost + (\cEmissionsIntensity - \vBaseline)\vPermitPrice)\vEnergy + \sum\limits_{\iGenerator \in \sGeneratorsExistingThermal} \left[\cStartupCost \cPowerOutputMax \vStartupIndicator + \cShutdownCost \cPowerOutputMax \vShutdownIndicator\right] \right.\\
& \left. + \sum\limits_{\iGenerator \in \sGeneratorsCandidateThermal} \left[\cStartupCost \vInstalledCapacityStartupStateAux + \cShutdownCost \vInstalledCapacityShutdownStateAux \right] \right]\\
\end{split}
\end{align}

\subsection{Policy constraints}

Cumulative emissions constraint:

\begin{equation}
\sum\limits_{\iYear \in \sYears} \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsThermal} \vEnergy \cEmissionsIntensity - \cEmmissionsCumulativeTarget - \vEmissionsTargetViolation \leq 0
\label{eqn: cumulative emissions target}
\end{equation}

Non-negative emissions target violation:
\begin{equation}
	-\vEmissionsTargetViolation \leq 0
	\label{eqn: non negative emissions target violation}
\end{equation}

%Cumulative revenue constraint:
%
%\begin{equation}
%\sum\limits_{\iYear \in \sYears} \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsExistingThermal \cup \sGeneratorsCandidate} \left(\cEmissionsIntensity - \vBaseline\right)\vPermitPrice\vEnergy \geq \cSchemeRevenueCumulativeTarget
%\label{eqn: cumulative revenue constraint}
%\end{equation}


\section{Solution Strategy}
The mathematical program described in the preceding sections is a mixed integer non-linear program (MINLP). The size of the problem becomes very large even when considering a small number of years and operating scenarios. To improve the computational tractability of the model a decomposition procedure is employed. A key source of non-linearity arises from the interaction of policy variables, $\vBaseline$ and $\vPermitPrice$, with energy output $\vEnergy$ in the objective function. To address this issue the decomposition approach first fixes these policy variables to zero, and simply seeks to solve for the investment path that achieves the cumulative emissions target given by (\ref{eqn: cumulative emissions target}). Having found the investment path that achieves this target for the lowest cost, the next goal is to identify the path of permit prices that achieves the same outcome. In some sense this approach is a similar to that adopted when solving macroeconomic models - first the social planner's problem is solved, with prices then introduced to see if an equivalent optimal outcome can be obtained. Having found the path of permit prices that replicates the cost minimising investment and output trajectory, an auxiliary objective function can then be solved to find the path of baselines that minimises disruptions to electricity prices while respecting the scheme revenue constraint.

\begin{figure}
	\includegraphics{solution_strategy.pdf}
	\caption{High-level decomposition strategy overview. Goal is to decompose the MINLP GEP such that each scenario is analysed independently, with the solutions then collated.}
\end{figure}

\subsection{Cost minimising investment and production trajectory}
First, the policy parameters $\vBaseline$ and $\vPermitPrice$ are set equal to zero. Note that~(\ref{eqn: non negative investment capacity})--(\ref{eqn: storage build limits}) and (\ref{eqn: cumulative emissions target}) are complicating constraints. Without these constraints the problem could be solved in blocks - one for each operating scenario, $\iScenario$. Optimality Condition Decomposition (OCD) is used to decompose this problem into blocks. This strategy involves distributing the complicating constraints to different blocks of equations (operating scenarios), and solving each block. Updated values for Lagrangian multipliers and fixed variables values are obtained upon finding solutions to these sub-problems. The following sections outline the decomposition strategy adopted.

\subsection{Optimality condition decomposition (OCD)}
This approach is a particular implementation of a Lagrangian Relaxation strategy. The goal is to break-up a large problem into a series of smaller problems by distributing complicating constraints to different sub-problems, as well as the objective functions of different sub-problems. Variables within complicating constraints assigned to a sub-problem, that are not decision variables for that sub-problem, are fixed. Once solutions have been obtained for all sub-problems the values of these fixed variables are updated, with the process repeated until the difference between successive iterations is less than some predefined tolerance. The following example, adapted from REF illustrates the basic principles of this decomposition approach.

Consider the problem:

\begin{equation}
	\minimise\limits_{\bm{x}_{a}; a=1,\ldots, A} \quad \sum\limits_{a=1}^{A}f_{a}(\bm{x}_{a})
\end{equation}

subject to

Constraints coupling variables between blocks.
\begin{equation}
	\bm{b}\left(\bm{x}_{1}, \ldots, \bm{x}_{A}\right) \leq \bm{0}
	\label{eqn: complicating inequality constraint}
\end{equation}

\begin{equation}
	\bm{c}\left(\bm{x}_{1}, \ldots, \bm{x}_{A}\right) = \bm{0}
	\label{eqn: complicating equality constraint}
\end{equation}

Constraints containing variables only relating to block $a$.
\begin{equation}
	\bm{d}_{a}\left(\bm{x}_{a}\right) \leq \bm{0} \quad \forall a = 1,\ldots,A
\end{equation}

\begin{equation}
	\bm{e}_{a}\left(\bm{x}_{a}\right) = \bm{0} \quad \forall a = 1,\ldots,A
\end{equation}

Constraints (\ref{eqn: complicating inequality constraint}) and (\ref{eqn: complicating equality constraint}) can be separated into different blocks, and terms for each complicating constraint included within the objective. The problem can then be re-written as:

\begin{equation}
\minimise\limits_{\bm{x}_{a}; a=1,\ldots, A} \quad \sum\limits_{a=1}^{A}f_{a}(\bm{x}_{a}) + \sum\limits_{a=1}^{A}\bm{\lambda}^{T}_{a}\bm{b}_{a}\left(\bm{x}_{1},\ldots,\bm{x}_{A}\right) + \sum\limits_{a=1}^{A}\bm{\mu}^{T}_{a}\bm{c}_{a}\left(\bm{x}_{1},\ldots,\bm{x}_{A}\right)
\end{equation}

subject to

Constraints coupling variables between blocks.
\begin{equation}
\bm{b}_{a}\left(\bm{x}_{1}, \ldots, \bm{x}_{A}\right) \leq \bm{0} \quad \forall a = 1,\ldots,A
\end{equation}

\begin{equation}
\bm{c}_{a}\left(\bm{x}_{1}, \ldots, \bm{x}_{A}\right) = \bm{0} \quad \forall a = 1,\ldots,A
\end{equation}

Constraints containing variables only relating to block $a$.
\begin{equation}
\bm{d}_{a}\left(\bm{x}_{a}\right) \leq \bm{0} \quad \forall a = 1,\ldots,A
\end{equation}

\begin{equation}
\bm{e}_{a}\left(\bm{x}_{a}\right) = \bm{0} \quad \forall a = 1,\ldots,A
\end{equation}

For each block, trial values are given to all variables that are not decision variables within that block. For example, block $a$'s problem could be expressed as:

\begin{equation}
\minimise\limits_{\bm{x}_{a}} \quad k + f_{a}(\bm{x}_{a}) + \sum\limits_{b=1,b\neq a}^{A}\overline{\bm{\lambda}}^{T}_{a}\bm{b}_{a}\left(\overline{\bm{x}}_{1},\ldots,\overline{\bm{x}}_{a-1},\bm{x}_{a},\overline{\bm{x}}_{a+1},\ldots,\overline{\bm{x}}_{A}\right) + \sum\limits_{b=1,b \neq a}^{A}\overline{\bm{\mu}}^{T}_{a}\bm{c}_{a}\left(\overline{\bm{x}}_{1},\ldots,\overline{\bm{x}}_{a-1},\bm{x}_{a},\overline{\bm{x}}_{a+1},\ldots,\overline{\bm{x}}_{A}\right)
\end{equation}

subject to

Constraints coupling variables between blocks.
\begin{equation}
\bm{b}_{a}\left(\overline{\bm{x}}_{1},\ldots,\overline{\bm{x}}_{a-1},\bm{x}_{a},\overline{\bm{x}}_{a+1},\ldots,\overline{\bm{x}}_{A}\right) \leq \bm{0} \quad (\bm{\lambda}_{a}^{T})
\end{equation}

\begin{equation}
\bm{c}_{a}\left(\overline{\bm{x}}_{1},\ldots,\overline{\bm{x}}_{a-1},\bm{x}_{a},\overline{\bm{x}}_{a+1},\ldots,\overline{\bm{x}}_{A}\right) = \bm{0} \quad (\bm{\mu}_{a}^{T})
\end{equation}

Constraints containing variables only relating to block $a$.
\begin{equation}
\bm{d}_{a}\left(\bm{x}_{a}\right) \leq \bm{0}
\end{equation}

\begin{equation}
\bm{e}_{a}\left(\bm{x}_{a}\right) = \bm{0}
\end{equation}

Where $k$ is a constant:

\begin{equation}
	k = \sum\limits_{b=1,b \neq a}^{A} f_{b}\left(\overline{\bm{x}_{b}}\right)
\end{equation}

Once all the sub-problems have been solved, their solutions are used to update values for dual variables in the objective functions (which are obtained from complicating constraints within each sub-problem), along with the values fixed values in each complicating constraint.

A generation expansion planning model has a similar structure to the model described above. For example:

\begin{equation}
\minimise\limits_{\bm{x}_{i},\bm{x}_{a}; a=1,\ldots, A} \quad f_{i}(\bm{x}_{i}) + \sum\limits_{a=1}^{A}f_{a}(\bm{x}_{a})
\end{equation}

subject to

Block of constraints for investment planning problem (e.g. ensuring build limits):

\begin{equation}
\bm{b}\left(\bm{x}_{i}\right) \leq \bm{0}
\end{equation}

\begin{equation}
\bm{c}\left(\bm{x}_{i}\right) = \bm{0}
\end{equation}

Blocks of constraints for each operating scenario, $a$ (e.g. standard unit commitment constraints).
\begin{equation}
\bm{d}_{a}\left(\bm{x}_{a}\right) \leq \bm{0} \quad \forall a = 1,\ldots,A
\end{equation}

\begin{equation}
\bm{e}_{a}\left(\bm{x}_{a}\right) = \bm{0} \quad \forall a = 1,\ldots,A
\end{equation}

Blocks of constraints coupling investment problem decision (e.g. size of candidate units) with operating scenario sub-problems:

\begin{equation}
\bm{g}_{a}\left(\bm{x}_{i}, \bm{x}_{a}\right) = \bm{0} \quad \forall a = 1,\ldots,A
\end{equation}

Constraints coupling investment problem with all operating scenario sub-problems (e.g. an emissions constraint):
\begin{equation}
h\left(\bm{x}_{i}, \bm{x}_{1}, \ldots, \bm{x}_{A}\right) = 0
\end{equation}


The problem can then be decomposed into two different sub-problems: an investment planning sub-problem which seeks to identify the optimal capacities for different generating units over the model horizon, and a series of operating scenario sub-problems to represent system operation when different capacity sizing decisions are employed. The structure of the investment sub-problem is given below:

\begin{equation}
	\minimise\limits_{\bm{x}_{i}} \quad f_{i}(\bm{x}_{i}) + \sum\limits_{a=1}^{A} \overline{\bm{\psi}}_{a}^{T} \bm{g}_{a}\left(\bm{x}_{i}, \overline{\bm{x}}_{a}\right)
\end{equation}

subject to

\begin{equation}
\bm{b} \left(\bm{x}_{i}\right) \leq \bm{0}
\end{equation}

\begin{equation}
\bm{c} \left(\bm{x}_{i}\right) = \bm{0}
\end{equation}

\begin{equation}
h\left(\bm{x}_{i}, \overline{\bm{x}}_{1}, \ldots, \overline{\bm{x}}_{A}\right) = 0 \quad (\lambda)
\end{equation}

And an operating scenario sub-problem of the form:

\begin{equation}
\minimise\limits_{\bm{x}_{a}} \quad k + f_{a}(\bm{x}_{a}) + \overline{\lambda}h\left(\overline{\bm{x}}_{i}, \overline{\bm{x}}_{1}, \ldots, \overline{\bm{x}}_{a-1}, \bm{x}_{a}, \overline{\bm{x}}_{a+1}, \ldots \overline{\bm{x}}_{A}\right)
\end{equation}

Subject to

Unit commitment constraints for operating scenario:
\begin{equation}
\bm{d}_{a}\left(\bm{x}_{a}\right) \leq \bm{0}
\end{equation}

\begin{equation}
\bm{e}_{a}\left(\bm{x}_{a}\right) = \bm{0}
\end{equation}

Constraints coupling investment problem decision (e.g. size of candidate units) with available capacity in operating scenarios:
\begin{equation}
\bm{g}_{a}\left(\bm{x}_{i}, \bm{x}_{a}\right) = \bm{0} \quad (\bm{\psi}_{a})
\end{equation}


\subsubsection{Applying OCD - GEP feasible investment plan}

The objective function is separated such that one program is dedicated to finding a feasible investment plan, while other sub-problems focus on solving the optimal dispatch plan for each operating scenario. Multiplier variables obtained from these dispatch plan sub-problems will be used to guide the solution of the feasible investment plan to the least-cost investment plan.

\begin{equation}
\minimise\limits_{\bm{x}_{\iYear,\iScenario}} \quad \cObjectiveFunction - \sum\limits_{\iGenerator \in \sGeneratorsCandidate}\sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios} \overline{\vFixedCapacityDual[]}_{\iGenerator,\iYear,\iScenario}\left[\overline{\vInstalledCapacityTotalScenario[]}_{\iGenerator,\iYear,\iScenario} - \vInstalledCapacityTotal\right]
\end{equation}

subject to

\begin{equation}
\vInstalledCapacity - \sum\limits_{\iInvestmentSizeOption \in \sInvestmentSizeOptionsGenerator} \vInvestmentSizeIndicator \cInvestmentSize = 0 \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears
\label{eqn: discrete capacity decision}
\end{equation}

\begin{equation}
\sum\limits_{\iInvestmentSizeOption \in \sInvestmentSizeOptionsGenerator} \vInvestmentSizeIndicator - 1 = 0 \quad \forall \iGenerator \in \sGeneratorsCandidateThermal \quad \forall \iYear \in \sYears
\end{equation}

\begin{equation}
- \vInstalledCapacity[\iGenerator,\iYear] \leq 0 \quad \forall \iGenerator \in \sGeneratorsCandidateSolar \cup \sGeneratorsCandidateWind \cup \sStorageCandidate \quad \forall \iYear \in \sYears
\end{equation}

\begin{equation}
\vInstalledCapacityTotal - \sum\limits_{\iYearAlias \leq \iYear} \vInstalledCapacity[\iGenerator,\iYearAlias] = 0 \quad \forall \iGenerator \in \sGeneratorsCandidate \quad \forall \iYear \in \sYears
\end{equation}

\begin{equation}
\sum\limits_{\iGenerator \in \sGeneratorsCandidateSolar_{\iZone}} \vInstalledCapacityTotal - \cBuildLimitSolar \leq 0 \quad \forall \iZone \in \sZones \quad \forall \iYear \in \sYears
\end{equation}

\begin{equation}
\sum\limits_{\iGenerator \in \sGeneratorsCandidateWind_{\iZone}} \vInstalledCapacityTotal - \cBuildLimitWind \leq 0 \quad \forall \iZone \in \sZones \quad \forall \iYear \in \sYears 
\end{equation}

\begin{equation}
\sum\limits_{\iGenerator \in \sStorageCandidate_{\iZone}} \vInstalledCapacityTotal - \cBuildLimitStorage \leq 0  \quad \forall \iZone \in \sZones \quad \forall \iYear \in \sYears
\label{eqn: storage build limit constraint}
\end{equation}

\begin{equation}
\sum\limits_{\iYear \in \sYears} \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsThermal} \overline{\vEnergy[]}_{\iGenerator,\iYear,\iScenario,\iInterval} \cEmissionsIntensity - \cEmmissionsCumulativeTarget - \vEmissionsTargetViolation \leq 0 \quad (\lambda)
	\label{eqn: cumulative emissions constraint}
\end{equation}

\begin{equation}
	- \vEmissionsTargetViolation \leq 0
	\label{eqn: non-negative emissions constraint violation}
\end{equation}

For convenience, let (\ref{eqn: cumulative emissions constraint}) be expressed as:

\begin{equation}
	\cEmissionsTotal - \cEmmissionsCumulativeTarget - \vEmissionsTargetViolation \leq 0 \quad (\lambda)
\end{equation}

Where:

\begin{equation}
	\cEmissionsTotal = \sum\limits_{\iYear \in \sYears} \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsThermal} \overline{\vEnergy[]}_{\iGenerator,\iYear,\iScenario,\iInterval} \cEmissionsIntensity
\end{equation}

With $\cEmissionsTotal$ evaluated by summing total emissions from all dispatch plan sub-problems. 

The objective function can be simplified by noting power and energy output are fixed in all periods. Therefore only investment and fixed operation and maintenance costs will constitute variable components within the objective. As operating costs are fixed in year for this sub-problem the objective function can be re-written as follows (expressions where all variables are fixed are overlined): 

\begin{equation}
\cObjectiveFunction = \sum\limits_{\iYear \in \sYears} \frac{\cDiscountRate}{\cInterestRate}\cInvestmentCost + \sum\limits_{\iYear \in \sYears} \left[\cDiscountRate (\overline{\cOperatingCost[]}_{\iYear} + \cFixedOperationsMaintenanceCost) \right] + \frac{\cDiscountRate}{\cInterestRate} \left(\overline{\cOperatingCost[]}_{\iYearTerminal} + \cFixedOperationsMaintenanceCost[\iYearTerminal] \right) + \cEmissionsTargetViolationPenalty \vEmissionsTargetViolation
\end{equation}

Separating these fixed expressions:

\begin{align}
	\begin{split}
		\cObjectiveFunction = &\sum\limits_{\iYear \in \sYears} \frac{\cDiscountRate}{\cInterestRate}\cInvestmentCost + \sum\limits_{\iYear \in \sYears} \cDiscountRate \cFixedOperationsMaintenanceCost  + \frac{(1+\cInterestRate)^{-\iYearTerminal}}{\cInterestRate} \cFixedOperationsMaintenanceCost[\iYearTerminal] + \cEmissionsTargetViolationPenalty \vEmissionsTargetViolation\\
		& + \sum\limits_{\iYear \in \sYears} \cDiscountRate \overline{\cOperatingCost[]}_{\iYear} + \frac{(1+\cInterestRate)^{-\iYearTerminal}}{\cInterestRate} \overline{\cOperatingCost[]}_{\iYearTerminal}
	\end{split}
\end{align}

Which can be re-written as:

\begin{equation}
	\cObjectiveFunction = \sum\limits_{\iYear \in \sYears} \frac{\cDiscountRate}{\cInterestRate}\cInvestmentCost + \sum\limits_{\iYear \in \sYears} \cDiscountRate \cFixedOperationsMaintenanceCost  + \frac{(1+\cInterestRate)^{-\iYearTerminal}}{\cInterestRate} \cFixedOperationsMaintenanceCost[\iYearTerminal] + \cEmissionsTargetViolationPenalty \vEmissionsTargetViolation + k_{a}
\end{equation}

Where:

\begin{equation}
	k_{a} = \sum\limits_{\iYear \in \sYears} \cDiscountRate \overline{\cOperatingCost[]}_{\iYear} + \frac{(1+\cInterestRate)^{-\iYearTerminal}}{\cInterestRate} \overline{\cOperatingCost[]}_{\iYearTerminal}
\end{equation}

As this constant has no bearing on the optimal investment plan it can be removed from the objective. Therefore the function to be minimised is as follows:

\begin{align}
	\begin{split}
		\minimise\limits_{\bm{x}_{a}} \quad & \sum\limits_{\iYear \in \sYears} \frac{\cDiscountRate}{\cInterestRate}\cInvestmentCost + \sum\limits_{\iYear \in \sYears} \cDiscountRate \cFixedOperationsMaintenanceCost  + \frac{(1+\cInterestRate)^{-\iYearTerminal}}{\cInterestRate} \cFixedOperationsMaintenanceCost[\iYearTerminal] + \cEmissionsTargetViolationPenalty \vEmissionsTargetViolation\\
		& - \sum\limits_{\iGenerator \in \sGeneratorsCandidate}\sum\limits_{\iYear \in \sYears}\sum\limits_{\iScenario \in \sScenarios} \overline{\vFixedCapacityDual[]}_{\iGenerator,\iYear,\iScenario}\left[\overline{\vInstalledCapacityTotalScenario[]}_{\iGenerator,\iYear,\iScenario} - \vInstalledCapacityTotal\right]
	\end{split}
\end{align}

Where $\bm{x}_{a} = \{\bm{x}^{\mathrm{C}}, \bm{a}, \bm{d}, \vEmissionsTargetViolation\}$

\subsubsection{Operating scenario sub-problems}
For a given year, $\iYear$, and operating scenario, $\iScenario$, the objective function of the sub-problem can be expressed as:

\begin{align}
	\begin{split}
		\minimise\limits_{\bm{x}_{\iYear,\iScenario}} \quad &\cObjectiveFunction - \sum\limits_{\iGenerator \in \sGeneratorsCandidate}\sum\limits_{\iYearAlias=1}^{\sYears}\sum\limits_{\iScenarioAlias \in \sScenarios^{\prime}} \overline{\vFixedCapacityDual[]}_{\iGenerator,\iYearAlias,\iScenarioAlias}\left[\overline{\vInstalledCapacityTotalScenario[]}_{\iGenerator,\iYearAlias,\iScenarioAlias} - \overline{\vInstalledCapacityTotal[]}_{\iGenerator,\iYearAlias}\right]\\
		& + \overline{\lambda} \left[\sum\limits_{\iYearAlias=1}^{\sYears} \sum\limits_{\iScenarioAlias \in \sScenarios^{\prime}} \cScenarioDuration[\iYearAlias,\iScenarioAlias] \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsThermal} \overline{\vEnergy[]}_{\iGenerator,\iYearAlias,\iScenarioAlias,\iInterval} \cEmissionsIntensity + \cScenarioDuration\sum\limits_{\iInterval \in \sIntervals}\sum\limits_{\iGenerator \in \sGeneratorsThermal} \vEnergy[\iGenerator,\iYear,\iScenario,\iInterval] \cEmissionsIntensity - \cEmmissionsCumulativeTarget - \overline{\vEmissionsTargetViolation}\right]\\
	\end{split}
\end{align}

Where:

\begin{equation}
	\sScenarios^{\prime} = 
	\begin{dcases}
	\sScenarios \setminus \{\iScenario\} & \mathrm{if} \quad \iYearAlias = \iYear\\
	\sScenarios & \mathrm{otherwise}\\
	\end{dcases}
\end{equation}

subject to

Unit commitment constraints for the given operating scenario: (\ref{eqn: reserve constraints})--(\ref{eqn: powerflow constraints}). Investment capacity coupling constraints:

\begin{equation}
\vInstalledCapacityTotalScenario - \overline{\vInstalledCapacityTotal[]}_{\iGenerator,\iYear} = 0 \quad (\vFixedCapacityDual) \quad \forall \iGenerator \in \sGeneratorsCandidate
\label{eqn: fixed candidate capacity constraint}
\end{equation}

Note that the second term in the objective is a constant, as is the term denoting emissions generated in all other operating scenarios. Allowing the objective to be re-written as:

\begin{equation}
	\minimise\limits_{\bm{x}_{\iYear,\iScenario}} \quad\cObjectiveFunction - k_{a} + \overline{\lambda} \left[k_{b} + \cScenarioDuration\sum\limits_{\iInterval \in \sIntervals}\sum\limits_{\iGenerator \in \sGeneratorsThermal} \vEnergy[\iGenerator,\iYear,\iScenario,\iInterval] \cEmissionsIntensity - \overline{\vEmissionsTargetViolation}\right]
\end{equation}

Where:

\begin{equation}
	k_{a} = \sum\limits_{\iGenerator \in \sGeneratorsCandidate}\sum\limits_{\iYearAlias=1}^{\sYears}\sum\limits_{\iScenarioAlias \in\sScenarios^{\prime}}\overline{\vFixedCapacityDual[]}_{\iGenerator,\iYearAlias,\iScenarioAlias}\left[\overline{\vInstalledCapacityTotalScenario[]}_{\iGenerator,\iYearAlias,\iScenarioAlias} - \overline{\vInstalledCapacityTotal[]}_{\iGenerator,\iYearAlias}\right]
\end{equation}

\begin{equation}
	k_{b} = \sum\limits_{\iYearAlias=1}^{\sYears} \sum\limits_{\iScenarioAlias \in \sScenarios^{\prime}}^{\sScenarios} \cScenarioDuration[\iYearAlias,\iScenarioAlias] \sum\limits_{\iInterval \in \sIntervals} \sum\limits_{\iGenerator \in \sGeneratorsThermal} \overline{\vEnergy[]}_{\iGenerator,\iYearAlias,\iScenarioAlias,\iInterval} \cEmissionsIntensity - \cEmmissionsCumulativeTarget - \overline{\vEmissionsTargetViolation}
\end{equation}

As $k_{a}$ and $k_{b}$ are constants they will not influence the optimal value of $\bm{x}_{\iYear,\iScenario}$ and can be omitted from the objective function, yielding:

\begin{equation}
	\minimise\limits_{\bm{x}_{\iYear,\iScenario}} \quad \cObjectiveFunction + \overline{\lambda} \left[\cScenarioDuration\sum\limits_{\iInterval \in \sIntervals}\sum\limits_{\iGenerator \in \sGeneratorsThermal} \vEnergy[\iGenerator,\iYear,\iScenario,\iInterval] \cEmissionsIntensity \right]
\end{equation}

Expanding $\cObjectiveFunction$:

\begin{equation}
	\cObjectiveFunction = \sum\limits_{\iYear \in \sYears} \frac{\cDiscountRate}{\cInterestRate}\cInvestmentCost + \sum\limits_{\iYear \in \sYears} \left[\cDiscountRate (\cOperatingCost[\iYear] + \cFixedOperationsMaintenanceCost) \right] + \frac{(1+\cInterestRate)^{-\iYearTerminal}}{\cInterestRate} \left(\cOperatingCost[\iYearTerminal] + \cFixedOperationsMaintenanceCost[\iYearTerminal] \right) + \cEmissionsTargetViolationPenalty \vEmissionsTargetViolation
\end{equation}

Note that $\cInvestmentCost$ only depends on $\vInstalledCapacity$ which is fixed when running each operating scenario. Similarly, $\cFixedOperationsMaintenanceCost$ only depends on $\vInstalledCapacityTotal$ which is also fixed when running each scenario. The amount by which the cumulative emissions target is exceeded, $\overline{\vEmissionsTargetViolation}$, is also fixed for all operating scenarios. Furthermore, the operating cost for all other scenarios, except the one under consideration, will also be fixed. These fixed expressions are denoted with overlines as shown below:

\begin{align}
	\begin{split}
		\cObjectiveFunction = & \sum\limits_{\iYearAlias=1}^{\sYears} \frac{(1+\cInterestRate)^{-\iYearAlias}}{\cInterestRate}\overline{\cInvestmentCost[]}_{\iYearAlias} + \sum\limits_{\iYearAlias=1, \iYearAlias \neq \iYear}^{\sYears} \left[(1+\cInterestRate)^{-\iYearAlias} (\overline{\cOperatingCost[]}_{\iYearAlias} + \overline{\cFixedOperationsMaintenanceCost[]}_{\iYearAlias}) \right]\\
		& + (1 + \cInterestRate)^{-\iYear}\left(\cOperatingCostScenario + \sum\limits_{\iScenarioAlias = 1,\iScenarioAlias\neq \iScenario}^{\sScenarios}\overline{\cOperatingCostScenario[]}_{\iYear,\iScenarioAlias} + \overline{\cFixedOperationsMaintenanceCost[]}_{\iYear}\right)\\
		& + \frac{(1+\cInterestRate)^{-\iYearTerminal}}{\cInterestRate} \left(\cOperatingCost[\iYearTerminal] + \overline{\cFixedOperationsMaintenanceCost[]}_{\iYearTerminal} \right) + \cEmissionsTargetViolationPenalty \overline{\vEmissionsTargetViolation}\\
	\end{split}
\end{align}


For all years, excluding the first and last years, the objective function for a given operating scenario can be expressed as:

\begin{equation}
	\cObjectiveFunction = k_{c} + \cOperatingCostScenario\cDiscountRate
\end{equation}

Where:

\begin{align}
\begin{split}
	k_{c} = & \sum\limits_{\iYearAlias=1}^{\sYears} \frac{(1+\cInterestRate)^{-\iYearAlias}}{\cInterestRate}\overline{\cInvestmentCost[]}_{\iYearAlias} + \sum\limits_{\iYearAlias=1, \iYearAlias \neq \iYear}^{\sYears} \left[(1+\cInterestRate)^{-\iYearAlias} (\overline{\cOperatingCost[]}_{\iYearAlias} + \overline{\cFixedOperationsMaintenanceCost[]}_{\iYearAlias}) \right]\\
	& + (1 + \cInterestRate)^{-\iYear}\left(\sum\limits_{\iScenarioAlias = 1,\iScenarioAlias\neq \iScenario}^{\sScenarios}\overline{\cOperatingCostScenario[]}_{\iYear,\iScenarioAlias} + \overline{\cFixedOperationsMaintenanceCost[]}_{\iYear}\right)\\
	& + \frac{(1+\cInterestRate)^{-\iYearTerminal}}{\cInterestRate} \left(\overline{\cOperatingCost[]}_{\iYearTerminal} + \overline{\cFixedOperationsMaintenanceCost[]}_{\iYearTerminal} \right) + \cEmissionsTargetViolationPenalty \overline{\vEmissionsTargetViolation}\\
\end{split}
\end{align}

As the constant term will not influence the optimal point it can be dropped from the objective. Therefore the objective function used to solve a given operating scenario (excluding last years) is:

\begin{equation}
	\cObjectiveFunction_{\iYear,\iScenario} = \cOperatingCostScenario\cDiscountRate
\end{equation}

If the last year of the model horizon, the final term within the $\cOperatingCost$ must be taken into account. This term assumes that the operating costs incurred in the final year will continue for all remaining years. As described previously, $\cFixedOperationsMaintenanceCost$ costs are treated as parameters, and can be removed form the objective:

\begin{equation}
	\cObjectiveFunction_{\iYearTerminal,\iScenario} = (1+\cInterestRate)^{-\iYearTerminal} \cOperatingCost[\iYearTerminal] + \frac{(1+\cInterestRate)^{-\iYearTerminal}}{\cInterestRate} \cOperatingCost[\iYearTerminal]
\end{equation}

Simplifying:

\begin{equation}
	\cObjectiveFunction_{\iYearTerminal,\iScenario} = \cOperatingCost[\iYearTerminal]\left[(1+\cInterestRate)^{-\iYearTerminal}  + \frac{(1+\cInterestRate)^{-\iYearTerminal}}{\cInterestRate}\right]
\end{equation}

Simplifying:

\begin{equation}
	\cObjectiveFunction_{\iYearTerminal,\iScenario} = \cOperatingCost[\iYearTerminal] \left[(1+\cInterestRate)^{-\iYearTerminal} \left[1 + \frac{1}{\cInterestRate}\right]\right]
\end{equation}

Simplifying:

\begin{equation}
	\cObjectiveFunction_{\iYearTerminal,\iScenario} = \cOperatingCost[\iYearTerminal] \left[(1+\cInterestRate)^{-\iYearTerminal} \left[ \frac{\cInterestRate + 1}{\cInterestRate}\right]\right]
\end{equation}

Considering all scenarios that constitute the final year:

\begin{equation}
	\cObjectiveFunction_{\iYearTerminal,\iScenario} = \sum\limits_{\iScenarioAlias \in \sScenarios^{\prime}} \overline{\cOperatingCostScenario[]}_{\iYearTerminal,\iScenarioAlias} \left[(1+\cInterestRate)^{-\iYearTerminal} \left[\frac{\cInterestRate + 1}{\cInterestRate}\right]\right] + \cOperatingCostScenario[\iYearTerminal,\iScenario] \left[(1+\cInterestRate)^{-\iYearTerminal} \left[\frac{\cInterestRate + 1}{\cInterestRate}\right]\right] 
\end{equation}

Which can be simplified to (as the constant terms will not impact the objective when solving for scenario $\iScenario$):

\begin{equation}
\cObjectiveFunction_{\iYearTerminal,\iScenario} = \cOperatingCostScenario[\iYearTerminal,\iScenario] \left[(1+\cInterestRate)^{-\iYearTerminal} \left[\frac{\cInterestRate + 1}{\cInterestRate}\right]\right] 
\end{equation}



\section{Benders decomposition}
The goal is to separate the operating scenario sub-problems from the investment plan (master) problem. For each operating scenario the candidate installed capacity will be fixed. The dual variables corresponding to constraints fixing the amount of candidate capacity available will be passed to the master problem to construct Benders cuts.

\subsection{Operating scenario sub-problems}
The objective function for all operating scenarios (except those constituting the final year in the model horizon) will have the form:

\begin{equation}
	\minimise\limits_{\bm{x}_{\iYear,\iScenario}} \quad \cOperatingCostScenario 
\end{equation}

Subject to (\ref{eqn: reserve constraints})--(\ref{eqn: lost-load energy constraint}). Candidate capacity is fixed in each sub-problem by the following constraint: 

\begin{equation}
\vInstalledCapacityTotalScenario - \vInstalledCapacityTotal^{(j)} = 0 \quad (\vFixedCapacityDual) \quad \forall \iGenerator \in \sGeneratorsCandidate
\end{equation}

The solution to this problem will yield: $\cOperatingCostScenario^{(j)}$ and $\vFixedCapacityDual^{(j)}$.

It is important to note that the discount factor, $\cDiscountRate$, and the duration of the operating scenario, $\cScenarioDuration$, are not taken into account when solving each sub-problem. These parameters are constants, and will not affect the solution of primal variables when solving each operating scenario. They will however impact the magnitude of dual variables. Consequently, dual variables will be scaled by these constants within the master problem to take this effect into account.

\subsection{Investment plan master problem (v1)}
The master problem is used to identify suitable values for candidate capacity variables.

\begin{equation}
	\minimise\limits_{\bm{y}} \quad \sum\limits_{\iYear \in \sYears} \frac{\cDiscountRate}{\cInterestRate}\cInvestmentCost + \sum\limits_{\iYear \in \sYears} \cDiscountRate \cFixedOperationsMaintenanceCost  + \frac{\cDiscountRate[\iYearTerminal]}{\cInterestRate} \cFixedOperationsMaintenanceCost[\iYearTerminal] + \alpha
\end{equation}

Subject to (\ref{eqn: discrete capacity decision})--(\ref{eqn: storage build limit constraint}). Benders cuts are given by:

\begin{align}
	\begin{split}
		\alpha \geq & \sum\limits_{\iYear \in \sYears} \cDiscountRate \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \cOperatingCostScenario^{(j)} + \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration[\iYearTerminal,\iScenario] \frac{\cDiscountRate[\iYearTerminal]}{\cInterestRate} \cOperatingCostScenario[\iYearTerminal,\iScenario]^{(j)} + \sum\limits_{\iYear \in \sYears} \cDiscountRate \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \sum\limits_{\iGenerator \in \sGeneratorsCandidate} \vFixedCapacityDual^{(j)} \left(\vInstalledCapacityTotal - \vInstalledCapacityTotal^{(j)}\right) \quad \forall j = 1,\ldots,\nu-1
	\end{split}
\end{align}

\subsection{Investment plan master problem (v2)}
In this formulation all investment and fixed operations costs are accounted for within the cut.

\begin{equation}
\minimise\limits_{\bm{y}} \quad \alpha
\end{equation}


Subject to (\ref{eqn: discrete capacity decision})--(\ref{eqn: storage build limit constraint}). Benders cuts are given by:

\begin{align}
	\begin{split}
		\alpha \geq & \sum\limits_{\iYear \in \sYears} \frac{\cDiscountRate}{\cInterestRate}\cInvestmentCost^{(j)} + \sum\limits_{\iYear \in \sYears} \cDiscountRate \cFixedOperationsMaintenanceCost^{(j)}  + \frac{\cDiscountRate[\iYearTerminal]}{\cInterestRate} \cFixedOperationsMaintenanceCost[\iYearTerminal]^{(j)} +  \sum\limits_{\iYear \in \sYears} \cDiscountRate \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \cOperatingCostScenario^{(j)} + \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration[\iYearTerminal,\iScenario] \frac{\cDiscountRate[\iYearTerminal]}{\cInterestRate} \cOperatingCostScenario[\iYearTerminal,\iScenario]^{(j)}\\
		& + \sum\limits_{\iYear \in \sYears} \cDiscountRate \sum\limits_{\iScenario \in \sScenarios} \cScenarioDuration \sum\limits_{\iGenerator \in \sGeneratorsCandidate} \vFixedCapacityDual^{(j)} \left(\vInstalledCapacityTotal - \vInstalledCapacityTotal^{(j)}\right) \quad \forall j = 1,\ldots,\nu-1
	\end{split}
\end{align}
\end{document}
